/*! For license information please see fde15935-1e8c3d28a4ed7f26e080.js.LICENSE.txt */
"use strict";(self.webpackChunkportfolio_3d=self.webpackChunkportfolio_3d||[]).push([[812],{6381:function(t,e,r){t=r.nmd(t);var n,o=Object.create,i=Object.defineProperty,a=Object.defineProperties,s=Object.getOwnPropertyDescriptor,c=Object.getOwnPropertyDescriptors,u=Object.getOwnPropertyNames,l=Object.getOwnPropertySymbols,f=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,p=(t,e,r)=>e in t?i(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,v=(t,e)=>{for(var r in e||(e={}))h.call(e,r)&&p(t,r,e[r]);if(l)for(var r of l(e))d.call(e,r)&&p(t,r,e[r]);return t},g=(t,e)=>a(t,c(e)),y=(t,e)=>function(){return e||(0,t[u(t)[0]])((e={exports:{}}).exports,e),e.exports},b=(t,e)=>{for(var r in e)i(t,r,{get:e[r],enumerable:!0})},_=(t,e,r,n)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let o of u(e))h.call(t,o)||o===r||i(t,o,{get:()=>e[o],enumerable:!(n=s(e,o))||n.enumerable});return t},m=(t,e,r)=>(r=null!=t?o(f(t)):{},_(!e&&t&&t.__esModule?r:i(r,"default",{value:t,enumerable:!0}),t)),j=(t,e,r)=>(p(t,"symbol"!=typeof e?e+"":e,r),r),w=y({"../node_modules/timing-function/lib/UnitBezier.js"(t,e){e.exports=function(){function t(t,e,r,n){this.set(t,e,r,n)}return t.prototype.set=function(t,e,r,n){this._cx=3*t,this._bx=3*(r-t)-this._cx,this._ax=1-this._cx-this._bx,this._cy=3*e,this._by=3*(n-e)-this._cy,this._ay=1-this._cy-this._by},t.epsilon=1e-6,t.prototype._sampleCurveX=function(t){return((this._ax*t+this._bx)*t+this._cx)*t},t.prototype._sampleCurveY=function(t){return((this._ay*t+this._by)*t+this._cy)*t},t.prototype._sampleCurveDerivativeX=function(t){return(3*this._ax*t+2*this._bx)*t+this._cx},t.prototype._solveCurveX=function(t,e){var r,n,o,i,a,s;for(o=void 0,i=void 0,a=void 0,s=void 0,r=void 0,n=void 0,a=t,n=0;n<8;){if(s=this._sampleCurveX(a)-t,Math.abs(s)<e)return a;if(r=this._sampleCurveDerivativeX(a),Math.abs(r)<e)break;a-=s/r,n++}if((a=t)<(o=0))return o;if(a>(i=1))return i;for(;o<i;){if(s=this._sampleCurveX(a),Math.abs(s-t)<e)return a;t>s?o=a:i=a,a=.5*(i-o)+o}return a},t.prototype.solve=function(t,e){return this._sampleCurveY(this._solveCurveX(t,e))},t.prototype.solveSimple=function(t){return this._sampleCurveY(this._solveCurveX(t,1e-6))},t}()}}),P=y({"../node_modules/levenshtein-edit-distance/index.js"(t,e){var r,n;r=[],n=[],e.exports=function(t,e,o){var i,a,s,c,u,l,f,h;if(t===e)return 0;if(i=t.length,a=e.length,0===i)return a;if(0===a)return i;for(o&&(t=t.toLowerCase(),e=e.toLowerCase()),f=0;f<i;)n[f]=t.charCodeAt(f),r[f]=++f;for(h=0;h<a;)for(s=e.charCodeAt(h),c=u=h++,f=-1;++f<i;)l=s===n[f]?u:u+1,u=r[f],r[f]=c=u>c?l>c?c+1:l:l>u?u+1:l;return c}}}),O=y({"../node_modules/propose/propose.js"(t,e){var r=P();e.exports=function(){var t,e,n,o,i,a=0,s=arguments[0],c=arguments[1],u=c.length,l=arguments[2];l&&(o=l.threshold,i=l.ignoreCase),void 0===o&&(o=0);for(var f=0;f<u;++f)(t=(e=i?r(s,c[f],!0):r(s,c[f]))>s.length?1-e/c[f].length:1-e/s.length)>a&&(a=t,n=c[f]);return a>=o?n:null}}}),S=y({"../node_modules/fast-deep-equal/index.js"(t,e){e.exports=function t(e,r){if(e===r)return!0;if(e&&r&&"object"==typeof e&&"object"==typeof r){if(e.constructor!==r.constructor)return!1;var n,o,i;if(Array.isArray(e)){if((n=e.length)!=r.length)return!1;for(o=n;0!=o--;)if(!t(e[o],r[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if((n=(i=Object.keys(e)).length)!==Object.keys(r).length)return!1;for(o=n;0!=o--;)if(!Object.prototype.hasOwnProperty.call(r,i[o]))return!1;for(o=n;0!=o--;){var a=i[o];if(!t(e[a],r[a]))return!1}return!0}return e!=e&&r!=r}}}),T={};b(T,{createRafDriver:()=>ja,getProject:()=>mc,notify:()=>ga,onChange:()=>wc,types:()=>Ca,val:()=>Pc}),t.exports=(n=T,_(i({},"__esModule",{value:!0}),n));var A={};b(A,{createRafDriver:()=>ja,getProject:()=>mc,notify:()=>ga,onChange:()=>wc,types:()=>Ca,val:()=>Pc});var k=r(4771),x=new class{constructor(){j(this,"atom",new k.Atom({projects:{}}))}add(t,e){this.atom.setByPointer((e=>e.projects[t]),e)}get(t){return this.atom.get().projects[t]}has(t){return!!this.get(t)}},D=new WeakMap;function I(t){return D.get(t)}function C(t,e){D.set(t,e)}var B=[],E=Array.isArray,M="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,F="object"==typeof self&&self&&self.Object===Object&&self,V=M||F||Function("return this")(),z=V.Symbol,R=Object.prototype,N=R.hasOwnProperty,U=R.toString,q=z?z.toStringTag:void 0;var L=function(t){var e=N.call(t,q),r=t[q];try{t[q]=void 0;var n=!0}catch(i){}var o=U.call(t);return n&&(e?t[q]=r:delete t[q]),o},$=Object.prototype.toString;var K=function(t){return $.call(t)},W=z?z.toStringTag:void 0;var H=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":W&&W in Object(t)?L(t):K(t)};var G=function(t){return null!=t&&"object"==typeof t};var J=function(t){return"symbol"==typeof t||G(t)&&"[object Symbol]"==H(t)},X=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Y=/^\w*$/;var Q=function(t,e){if(E(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!J(t))||(Y.test(t)||!X.test(t)||null!=e&&t in Object(e))};var Z=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var tt,et=function(t){if(!Z(t))return!1;var e=H(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},rt=V["__core-js_shared__"],nt=(tt=/[^.]+$/.exec(rt&&rt.keys&&rt.keys.IE_PROTO||""))?"Symbol(src)_1."+tt:"";var ot=function(t){return!!nt&&nt in t},it=Function.prototype.toString;var at=function(t){if(null!=t){try{return it.call(t)}catch(e){}try{return t+""}catch(e){}}return""},st=/^\[object .+?Constructor\]$/,ct=Function.prototype,ut=Object.prototype,lt=ct.toString,ft=ut.hasOwnProperty,ht=RegExp("^"+lt.call(ft).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var dt=function(t){return!(!Z(t)||ot(t))&&(et(t)?ht:st).test(at(t))};var pt=function(t,e){return null==t?void 0:t[e]};var vt=function(t,e){var r=pt(t,e);return dt(r)?r:void 0},gt=vt(Object,"create");var yt=function(){this.__data__=gt?gt(null):{},this.size=0};var bt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},_t=Object.prototype.hasOwnProperty;var mt=function(t){var e=this.__data__;if(gt){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return _t.call(e,t)?e[t]:void 0},jt=Object.prototype.hasOwnProperty;var wt=function(t){var e=this.__data__;return gt?void 0!==e[t]:jt.call(e,t)};var Pt=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=gt&&void 0===e?"__lodash_hash_undefined__":e,this};function Ot(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Ot.prototype.clear=yt,Ot.prototype.delete=bt,Ot.prototype.get=mt,Ot.prototype.has=wt,Ot.prototype.set=Pt;var St=Ot;var Tt=function(){this.__data__=[],this.size=0};var At=function(t,e){return t===e||t!=t&&e!=e};var kt=function(t,e){for(var r=t.length;r--;)if(At(t[r][0],e))return r;return-1},xt=Array.prototype.splice;var Dt=function(t){var e=this.__data__,r=kt(e,t);return!(r<0)&&(r==e.length-1?e.pop():xt.call(e,r,1),--this.size,!0)};var It=function(t){var e=this.__data__,r=kt(e,t);return r<0?void 0:e[r][1]};var Ct=function(t){return kt(this.__data__,t)>-1};var Bt=function(t,e){var r=this.__data__,n=kt(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function Et(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Et.prototype.clear=Tt,Et.prototype.delete=Dt,Et.prototype.get=It,Et.prototype.has=Ct,Et.prototype.set=Bt;var Mt=Et,Ft=vt(V,"Map");var Vt=function(){this.size=0,this.__data__={hash:new St,map:new(Ft||Mt),string:new St}};var zt=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var Rt=function(t,e){var r=t.__data__;return zt(e)?r["string"==typeof e?"string":"hash"]:r.map};var Nt=function(t){var e=Rt(this,t).delete(t);return this.size-=e?1:0,e};var Ut=function(t){return Rt(this,t).get(t)};var qt=function(t){return Rt(this,t).has(t)};var Lt=function(t,e){var r=Rt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function $t(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}$t.prototype.clear=Vt,$t.prototype.delete=Nt,$t.prototype.get=Ut,$t.prototype.has=qt,$t.prototype.set=Lt;var Kt=$t;function Wt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(Wt.Cache||Kt),r}Wt.Cache=Kt;var Ht=Wt;var Gt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Jt=/\\(\\)?/g,Xt=function(t){var e=Ht(t,(function(t){return 500===r.size&&r.clear(),t})),r=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Gt,(function(t,r,n,o){e.push(n?o.replace(Jt,"$1"):r||t)})),e}));var Yt=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o},Qt=z?z.prototype:void 0,Zt=Qt?Qt.toString:void 0;var te=function t(e){if("string"==typeof e)return e;if(E(e))return Yt(e,t)+"";if(J(e))return Zt?Zt.call(e):"";var r=e+"";return"0"==r&&1/e==-Infinity?"-0":r};var ee=function(t){return null==t?"":te(t)};var re=function(t,e){return E(t)?t:Q(t,e)?[t]:Xt(ee(t))};var ne=function(t){if("string"==typeof t||J(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e};var oe=function(t,e){for(var r=0,n=(e=re(e,t)).length;null!=t&&r<n;)t=t[ne(e[r++])];return r&&r==n?t:void 0};var ie=function(t,e,r){var n=null==t?void 0:oe(t,e);return void 0===n?r:n};function ae(t,e){return 0===e.length?t:ie(t,e)}var se=class{constructor(){j(this,"_values",{})}get(t,e){if(this.has(t))return this._values[t];{const r=e();return this._values[t]=r,r}}has(t){return this._values.hasOwnProperty(t)}},ce=r(4771),ue=function(){try{var t=vt(Object,"defineProperty");return t({},"",{}),t}catch(e){}}();var le=function(t,e,r){"__proto__"==e&&ue?ue(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r},fe=Object.prototype.hasOwnProperty;var he=function(t,e,r){var n=t[e];fe.call(t,e)&&At(n,r)&&(void 0!==r||e in t)||le(t,e,r)},de=/^(?:0|[1-9]\d*)$/;var pe=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&de.test(t))&&t>-1&&t%1==0&&t<e};var ve=function(t,e,r,n){if(!Z(t))return t;for(var o=-1,i=(e=re(e,t)).length,a=i-1,s=t;null!=s&&++o<i;){var c=ne(e[o]),u=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(o!=a){var l=s[c];void 0===(u=n?n(l,c,s):void 0)&&(u=Z(l)?l:pe(e[o+1])?[]:{})}he(s,c,u),s=s[c]}return t};var ge=function(t,e,r){return null==t?t:ve(t,e,r)},ye=new WeakMap;function be(t){if(ye.has(t))return ye.get(t);const e="compound"===t.type?function(t){const e={};for(const[r,n]of Object.entries(t.props))e[r]=be(n);return e}(t):"enum"===t.type?function(t){const e={$case:t.defaultCase};for(const[r,n]of Object.entries(t.cases))e[r]=be(n);return e}(t):t.default;return ye.set(t,e),e}var _e=r(4771),me=m(w());function je(t,e,r){return(0,_e.prism)((()=>{const n=(0,_e.val)(e),o=_e.prism.memo("driver",(()=>n?"BasicKeyframedTrack"===n.type?function(t,e,r){return(0,_e.prism)((()=>{let t=_e.prism.ref("state",{started:!1}),n=t.current;const o=r.getValue();return(!n.started||o<n.validFrom||n.validTo<=o)&&(t.current=n=function(t,e,r){const n=e.getValue();if(0===r.keyframes.length)return{started:!0,validFrom:-1/0,validTo:1/0,der:we};let o=0;for(;;){const t=r.keyframes[o];if(!t)return Pe.error;const i=o===r.keyframes.length-1;if(n<t.position)return 0===o?Pe.beforeFirstKeyframe(t):Pe.error;if(t.position===n)return i?Pe.lastKeyframe(t):Pe.between(t,r.keyframes[o+1],e);if(o===r.keyframes.length-1)return Pe.lastKeyframe(t);{const i=o+1;if(r.keyframes[i].position<=n){o=i;continue}return Pe.between(t,r.keyframes[o+1],e)}}}(0,r,e)),n.der.getValue()}))}(0,n,r):(t.logger.error("Track type not yet supported."),(0,_e.prism)((()=>{}))):(0,_e.prism)((()=>{}))),[n]);return o.getValue()}))}var we=(0,_e.prism)((()=>{}));var Pe={beforeFirstKeyframe(t){return{started:!0,validFrom:-1/0,validTo:t.position,der:(0,_e.prism)((()=>({left:t.value,progression:0})))}},lastKeyframe(t){return{started:!0,validFrom:t.position,validTo:1/0,der:(0,_e.prism)((()=>({left:t.value,progression:0})))}},between(t,e,r){if(!t.connectedRight)return{started:!0,validFrom:t.position,validTo:e.position,der:(0,_e.prism)((()=>({left:t.value,progression:0})))};const n=r=>(r-t.position)/(e.position-t.position);if(!t.type||"bezier"===t.type){const o=new me.default(t.handles[2],t.handles[3],e.handles[0],e.handles[1]),i=(0,_e.prism)((()=>{const i=n(r.getValue()),a=o.solveSimple(i);return{left:t.value,right:e.value,progression:a}}));return{started:!0,validFrom:t.position,validTo:e.position,der:i}}const o=(0,_e.prism)((()=>{const o=n(r.getValue()),i=Math.floor(o);return{left:t.value,right:e.value,progression:i}}));return{started:!0,validFrom:t.position,validTo:e.position,der:o}},error:{started:!0,validFrom:-1/0,validTo:1/0,der:we}};function Oe(t,e,r){const n=r.get(t);if(n&&n.override===e)return n.merged;const o=v({},t);for(const i of Object.keys(e)){const n=e[i],a=t[i];o[i]="object"==typeof n&&"object"==typeof a?Oe(a,n,r):void 0===n?a:n}return r.set(t,{override:e,merged:o}),o}function Se(t,e){let r=t;for(const n of e)r=r[n];return r}var Te=r(4771),Ae=r(4771),ke=r(4771),xe=/\s/;var De=function(t){for(var e=t.length;e--&&xe.test(t.charAt(e)););return e},Ie=/^\s+/;var Ce=function(t){return t?t.slice(0,De(t)+1).replace(Ie,""):t},Be=/^[-+]0x[0-9a-f]+$/i,Ee=/^0b[01]+$/i,Me=/^0o[0-7]+$/i,Fe=parseInt;var Ve=function(t){if("number"==typeof t)return t;if(J(t))return NaN;if(Z(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Z(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ce(t);var r=Ee.test(t);return r||Me.test(t)?Fe(t.slice(2),r?2:8):Be.test(t)?NaN:+t},ze=1/0;var Re=function(t){return t?(t=Ve(t))===ze||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var Ne=function(t){var e=Re(t),r=e%1;return e==e?r?e-r:e:0};var Ue=function(t){return t},qe=vt(V,"WeakMap"),Le=Object.create,$e=function(){function t(){}return function(e){if(!Z(e))return{};if(Le)return Le(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();var Ke=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e};var We=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t};var He=function(t,e,r,n){var o=!r;r||(r={});for(var i=-1,a=e.length;++i<a;){var s=e[i],c=n?n(r[s],t[s],s,r,t):void 0;void 0===c&&(c=t[s]),o?le(r,s,c):he(r,s,c)}return r};var Ge=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var Je=function(t){return null!=t&&Ge(t.length)&&!et(t)},Xe=Object.prototype;var Ye=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Xe)};var Qe=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n};var Ze=function(t){return G(t)&&"[object Arguments]"==H(t)},tr=Object.prototype,er=tr.hasOwnProperty,rr=tr.propertyIsEnumerable,nr=Ze(function(){return arguments}())?Ze:function(t){return G(t)&&er.call(t,"callee")&&!rr.call(t,"callee")},or=nr;var ir=function(){return!1},ar=e&&!e.nodeType&&e,sr=ar&&t&&!t.nodeType&&t,cr=sr&&sr.exports===ar?V.Buffer:void 0,ur=(cr?cr.isBuffer:void 0)||ir,lr={};lr["[object Float32Array]"]=lr["[object Float64Array]"]=lr["[object Int8Array]"]=lr["[object Int16Array]"]=lr["[object Int32Array]"]=lr["[object Uint8Array]"]=lr["[object Uint8ClampedArray]"]=lr["[object Uint16Array]"]=lr["[object Uint32Array]"]=!0,lr["[object Arguments]"]=lr["[object Array]"]=lr["[object ArrayBuffer]"]=lr["[object Boolean]"]=lr["[object DataView]"]=lr["[object Date]"]=lr["[object Error]"]=lr["[object Function]"]=lr["[object Map]"]=lr["[object Number]"]=lr["[object Object]"]=lr["[object RegExp]"]=lr["[object Set]"]=lr["[object String]"]=lr["[object WeakMap]"]=!1;var fr=function(t){return G(t)&&Ge(t.length)&&!!lr[H(t)]};var hr=function(t){return function(e){return t(e)}},dr=e&&!e.nodeType&&e,pr=dr&&t&&!t.nodeType&&t,vr=pr&&pr.exports===dr&&M.process,gr=function(){try{var t=pr&&pr.require&&pr.require("util").types;return t||vr&&vr.binding&&vr.binding("util")}catch(e){}}(),yr=gr&&gr.isTypedArray,br=yr?hr(yr):fr,_r=Object.prototype.hasOwnProperty;var mr=function(t,e){var r=E(t),n=!r&&or(t),o=!r&&!n&&ur(t),i=!r&&!n&&!o&&br(t),a=r||n||o||i,s=a?Qe(t.length,String):[],c=s.length;for(var u in t)!e&&!_r.call(t,u)||a&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||pe(u,c))||s.push(u);return s};var jr=function(t,e){return function(r){return t(e(r))}},wr=jr(Object.keys,Object),Pr=Object.prototype.hasOwnProperty;var Or=function(t){if(!Ye(t))return wr(t);var e=[];for(var r in Object(t))Pr.call(t,r)&&"constructor"!=r&&e.push(r);return e};var Sr=function(t){return Je(t)?mr(t):Or(t)};var Tr=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e},Ar=Object.prototype.hasOwnProperty;var kr=function(t){if(!Z(t))return Tr(t);var e=Ye(t),r=[];for(var n in t)("constructor"!=n||!e&&Ar.call(t,n))&&r.push(n);return r};var xr=function(t){return Je(t)?mr(t,!0):kr(t)};var Dr=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t},Ir=jr(Object.getPrototypeOf,Object),Cr=Function.prototype,Br=Object.prototype,Er=Cr.toString,Mr=Br.hasOwnProperty,Fr=Er.call(Object);var Vr=function(t){if(!G(t)||"[object Object]"!=H(t))return!1;var e=Ir(t);if(null===e)return!0;var r=Mr.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Er.call(r)==Fr};var zr=function(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(r=r>o?o:r)<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var i=Array(o);++n<o;)i[n]=t[n+e];return i};var Rr=function(t,e,r){var n=t.length;return r=void 0===r?n:r,!e&&r>=n?t:zr(t,e,r)},Nr=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Ur=function(t){return Nr.test(t)};var qr=function(t){return t.split("")},Lr="\\ud800-\\udfff",$r="["+Lr+"]",Kr="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Wr="\\ud83c[\\udffb-\\udfff]",Hr="[^"+Lr+"]",Gr="(?:\\ud83c[\\udde6-\\uddff]){2}",Jr="[\\ud800-\\udbff][\\udc00-\\udfff]",Xr="(?:"+Kr+"|"+Wr+")"+"?",Yr="[\\ufe0e\\ufe0f]?",Qr=Yr+Xr+("(?:\\u200d(?:"+[Hr,Gr,Jr].join("|")+")"+Yr+Xr+")*"),Zr="(?:"+[Hr+Kr+"?",Kr,Gr,Jr,$r].join("|")+")",tn=RegExp(Wr+"(?="+Wr+")|"+Zr+Qr,"g");var en=function(t){return t.match(tn)||[]};var rn=function(t){return Ur(t)?en(t):qr(t)};var nn=function(t,e,r){return t==t&&(void 0!==r&&(t=t<=r?t:r),void 0!==e&&(t=t>=e?t:e)),t};var on=function(t,e,r){return void 0===r&&(r=e,e=void 0),void 0!==r&&(r=(r=Ve(r))==r?r:0),void 0!==e&&(e=(e=Ve(e))==e?e:0),nn(Ve(t),e,r)};var an=function(){this.__data__=new Mt,this.size=0};var sn=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r};var cn=function(t){return this.__data__.get(t)};var un=function(t){return this.__data__.has(t)};var ln=function(t,e){var r=this.__data__;if(r instanceof Mt){var n=r.__data__;if(!Ft||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Kt(n)}return r.set(t,e),this.size=r.size,this};function fn(t){var e=this.__data__=new Mt(t);this.size=e.size}fn.prototype.clear=an,fn.prototype.delete=sn,fn.prototype.get=cn,fn.prototype.has=un,fn.prototype.set=ln;var hn=fn;var dn=function(t,e){return t&&He(e,Sr(e),t)};var pn=function(t,e){return t&&He(e,xr(e),t)},vn=e&&!e.nodeType&&e,gn=vn&&t&&!t.nodeType&&t,yn=gn&&gn.exports===vn?V.Buffer:void 0,bn=yn?yn.allocUnsafe:void 0;var _n=function(t,e){if(e)return t.slice();var r=t.length,n=bn?bn(r):new t.constructor(r);return t.copy(n),n};var mn=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var a=t[r];e(a,r,t)&&(i[o++]=a)}return i};var jn=function(){return[]},wn=Object.prototype.propertyIsEnumerable,Pn=Object.getOwnPropertySymbols,On=Pn?function(t){return null==t?[]:(t=Object(t),mn(Pn(t),(function(e){return wn.call(t,e)})))}:jn;var Sn=function(t,e){return He(t,On(t),e)},Tn=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Dr(e,On(t)),t=Ir(t);return e}:jn;var An=function(t,e){return He(t,Tn(t),e)};var kn=function(t,e,r){var n=e(t);return E(t)?n:Dr(n,r(t))};var xn=function(t){return kn(t,Sr,On)};var Dn=function(t){return kn(t,xr,Tn)},In=vt(V,"DataView"),Cn=vt(V,"Promise"),Bn=vt(V,"Set"),En="[object Map]",Mn="[object Promise]",Fn="[object Set]",Vn="[object WeakMap]",zn="[object DataView]",Rn=at(In),Nn=at(Ft),Un=at(Cn),qn=at(Bn),Ln=at(qe),$n=H;(In&&$n(new In(new ArrayBuffer(1)))!=zn||Ft&&$n(new Ft)!=En||Cn&&$n(Cn.resolve())!=Mn||Bn&&$n(new Bn)!=Fn||qe&&$n(new qe)!=Vn)&&($n=function(t){var e=H(t),r="[object Object]"==e?t.constructor:void 0,n=r?at(r):"";if(n)switch(n){case Rn:return zn;case Nn:return En;case Un:return Mn;case qn:return Fn;case Ln:return Vn}return e});var Kn=$n,Wn=Object.prototype.hasOwnProperty;var Hn=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&Wn.call(t,"index")&&(r.index=t.index,r.input=t.input),r},Gn=V.Uint8Array;var Jn=function(t){var e=new t.constructor(t.byteLength);return new Gn(e).set(new Gn(t)),e};var Xn=function(t,e){var r=e?Jn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)},Yn=/\w*$/;var Qn=function(t){var e=new t.constructor(t.source,Yn.exec(t));return e.lastIndex=t.lastIndex,e},Zn=z?z.prototype:void 0,to=Zn?Zn.valueOf:void 0;var eo=function(t){return to?Object(to.call(t)):{}};var ro=function(t,e){var r=e?Jn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)};var no=function(t,e,r){var n=t.constructor;switch(e){case"[object ArrayBuffer]":return Jn(t);case"[object Boolean]":case"[object Date]":return new n(+t);case"[object DataView]":return Xn(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return ro(t,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(t);case"[object RegExp]":return Qn(t);case"[object Symbol]":return eo(t)}};var oo=function(t){return"function"!=typeof t.constructor||Ye(t)?{}:$e(Ir(t))};var io=function(t){return G(t)&&"[object Map]"==Kn(t)},ao=gr&&gr.isMap,so=ao?hr(ao):io;var co=function(t){return G(t)&&"[object Set]"==Kn(t)},uo=gr&&gr.isSet,lo=uo?hr(uo):co,fo="[object Arguments]",ho="[object Function]",po="[object Object]",vo={};vo[fo]=vo["[object Array]"]=vo["[object ArrayBuffer]"]=vo["[object DataView]"]=vo["[object Boolean]"]=vo["[object Date]"]=vo["[object Float32Array]"]=vo["[object Float64Array]"]=vo["[object Int8Array]"]=vo["[object Int16Array]"]=vo["[object Int32Array]"]=vo["[object Map]"]=vo["[object Number]"]=vo[po]=vo["[object RegExp]"]=vo["[object Set]"]=vo["[object String]"]=vo["[object Symbol]"]=vo["[object Uint8Array]"]=vo["[object Uint8ClampedArray]"]=vo["[object Uint16Array]"]=vo["[object Uint32Array]"]=!0,vo["[object Error]"]=vo[ho]=vo["[object WeakMap]"]=!1;var go=function t(e,r,n,o,i,a){var s,c=1&r,u=2&r,l=4&r;if(n&&(s=i?n(e,o,i,a):n(e)),void 0!==s)return s;if(!Z(e))return e;var f=E(e);if(f){if(s=Hn(e),!c)return Ke(e,s)}else{var h=Kn(e),d=h==ho||"[object GeneratorFunction]"==h;if(ur(e))return _n(e,c);if(h==po||h==fo||d&&!i){if(s=u||d?{}:oo(e),!c)return u?An(e,pn(s,e)):Sn(e,dn(s,e))}else{if(!vo[h])return i?e:{};s=no(e,h,c)}}a||(a=new hn);var p=a.get(e);if(p)return p;a.set(e,s),lo(e)?e.forEach((function(o){s.add(t(o,r,n,o,e,a))})):so(e)&&e.forEach((function(o,i){s.set(i,t(o,r,n,i,e,a))}));var v=f?void 0:(l?u?Dn:xn:u?xr:Sr)(e);return We(v||e,(function(o,i){v&&(o=e[i=o]),he(s,i,t(o,r,n,i,e,a))})),s};var yo=function(t){return go(t,5)};var bo=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var _o=function(t){return this.__data__.has(t)};function mo(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Kt;++e<r;)this.add(t[e])}mo.prototype.add=mo.prototype.push=bo,mo.prototype.has=_o;var jo=mo;var wo=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1};var Po=function(t,e){return t.has(e)};var Oo=function(t,e,r,n,o,i){var a=1&r,s=t.length,c=e.length;if(s!=c&&!(a&&c>s))return!1;var u=i.get(t),l=i.get(e);if(u&&l)return u==e&&l==t;var f=-1,h=!0,d=2&r?new jo:void 0;for(i.set(t,e),i.set(e,t);++f<s;){var p=t[f],v=e[f];if(n)var g=a?n(v,p,f,e,t,i):n(p,v,f,t,e,i);if(void 0!==g){if(g)continue;h=!1;break}if(d){if(!wo(e,(function(t,e){if(!Po(d,e)&&(p===t||o(p,t,r,n,i)))return d.push(e)}))){h=!1;break}}else if(p!==v&&!o(p,v,r,n,i)){h=!1;break}}return i.delete(t),i.delete(e),h};var So=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r};var To=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r},Ao=z?z.prototype:void 0,ko=Ao?Ao.valueOf:void 0;var xo=function(t,e,r,n,o,i,a){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!i(new Gn(t),new Gn(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return At(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var s=So;case"[object Set]":var c=1&n;if(s||(s=To),t.size!=e.size&&!c)return!1;var u=a.get(t);if(u)return u==e;n|=2,a.set(t,e);var l=Oo(s(t),s(e),n,o,i,a);return a.delete(t),l;case"[object Symbol]":if(ko)return ko.call(t)==ko.call(e)}return!1},Do=Object.prototype.hasOwnProperty;var Io=function(t,e,r,n,o,i){var a=1&r,s=xn(t),c=s.length;if(c!=xn(e).length&&!a)return!1;for(var u=c;u--;){var l=s[u];if(!(a?l in e:Do.call(e,l)))return!1}var f=i.get(t),h=i.get(e);if(f&&h)return f==e&&h==t;var d=!0;i.set(t,e),i.set(e,t);for(var p=a;++u<c;){var v=t[l=s[u]],g=e[l];if(n)var y=a?n(g,v,l,e,t,i):n(v,g,l,t,e,i);if(!(void 0===y?v===g||o(v,g,r,n,i):y)){d=!1;break}p||(p="constructor"==l)}if(d&&!p){var b=t.constructor,_=e.constructor;b==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof b&&b instanceof b&&"function"==typeof _&&_ instanceof _||(d=!1)}return i.delete(t),i.delete(e),d},Co="[object Arguments]",Bo="[object Array]",Eo="[object Object]",Mo=Object.prototype.hasOwnProperty;var Fo=function(t,e,r,n,o,i){var a=E(t),s=E(e),c=a?Bo:Kn(t),u=s?Bo:Kn(e),l=(c=c==Co?Eo:c)==Eo,f=(u=u==Co?Eo:u)==Eo,h=c==u;if(h&&ur(t)){if(!ur(e))return!1;a=!0,l=!1}if(h&&!l)return i||(i=new hn),a||br(t)?Oo(t,e,r,n,o,i):xo(t,e,c,r,n,o,i);if(!(1&r)){var d=l&&Mo.call(t,"__wrapped__"),p=f&&Mo.call(e,"__wrapped__");if(d||p){var v=d?t.value():t,g=p?e.value():e;return i||(i=new hn),o(v,g,r,n,i)}}return!!h&&(i||(i=new hn),Io(t,e,r,n,o,i))};var Vo=function t(e,r,n,o,i){return e===r||(null==e||null==r||!G(e)&&!G(r)?e!=e&&r!=r:Fo(e,r,n,o,t,i))};var zo=function(t,e,r,n){var o=r.length,i=o,a=!n;if(null==t)return!i;for(t=Object(t);o--;){var s=r[o];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++o<i;){var c=(s=r[o])[0],u=t[c],l=s[1];if(a&&s[2]){if(void 0===u&&!(c in t))return!1}else{var f=new hn;if(n)var h=n(u,l,c,t,e,f);if(!(void 0===h?Vo(l,u,3,n,f):h))return!1}}return!0};var Ro=function(t){return t==t&&!Z(t)};var No=function(t){for(var e=Sr(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,Ro(o)]}return e};var Uo=function(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}};var qo=function(t){var e=No(t);return 1==e.length&&e[0][2]?Uo(e[0][0],e[0][1]):function(r){return r===t||zo(r,t,e)}};var Lo=function(t,e){return null!=t&&e in Object(t)};var $o=function(t,e,r){for(var n=-1,o=(e=re(e,t)).length,i=!1;++n<o;){var a=ne(e[n]);if(!(i=null!=t&&r(t,a)))break;t=t[a]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&Ge(o)&&pe(a,o)&&(E(t)||or(t))};var Ko=function(t,e){return null!=t&&$o(t,e,Lo)};var Wo=function(t,e){return Q(t)&&Ro(e)?Uo(ne(t),e):function(r){var n=ie(r,t);return void 0===n&&n===e?Ko(r,t):Vo(e,n,3)}};var Ho=function(t){return function(e){return null==e?void 0:e[t]}};var Go=function(t){return function(e){return oe(e,t)}};var Jo=function(t){return Q(t)?Ho(ne(t)):Go(t)};var Xo=function(t){return"function"==typeof t?t:null==t?Ue:"object"==typeof t?E(t)?Wo(t[0],t[1]):qo(t):Jo(t)};var Yo=function(t){return function(e,r,n){for(var o=-1,i=Object(e),a=n(e),s=a.length;s--;){var c=a[t?s:++o];if(!1===r(i[c],c,i))break}return e}}();var Qo=function(t,e){return t&&Yo(t,e,Sr)},Zo=function(){return V.Date.now()},ti=Math.max,ei=Math.min;var ri=function(t,e,r){var n,o,i,a,s,c,u=0,l=!1,f=!1,h=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function d(e){var r=n,i=o;return n=o=void 0,u=e,a=t.apply(i,r)}function p(t){var r=t-c;return void 0===c||r>=e||r<0||f&&t-u>=i}function v(){var t=Zo();if(p(t))return g(t);s=setTimeout(v,function(t){var r=e-(t-c);return f?ei(r,i-(t-u)):r}(t))}function g(t){return s=void 0,h&&n?d(t):(n=o=void 0,a)}function y(){var t=Zo(),r=p(t);if(n=arguments,o=this,c=t,r){if(void 0===s)return function(t){return u=t,s=setTimeout(v,e),l?d(t):a}(c);if(f)return clearTimeout(s),s=setTimeout(v,e),d(c)}return void 0===s&&(s=setTimeout(v,e)),a}return e=Ve(e)||0,Z(r)&&(l=!!r.leading,i=(f="maxWait"in r)?ti(Ve(r.maxWait)||0,e):i,h="trailing"in r?!!r.trailing:h),y.cancel=function(){void 0!==s&&clearTimeout(s),u=0,n=c=o=s=void 0},y.flush=function(){return void 0===s?a:g(Zo())},y};var ni=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0};var oi=function(t,e){return e.length<2?t:oe(t,zr(e,0,-1))};var ii=function(t){return"number"==typeof t&&t==Ne(t)};var ai=function(t,e){var r={};return e=Xo(e,3),Qo(t,(function(t,n,o){le(r,n,e(t,n,o))})),r};var si=function(t,e){return e=re(e,t),null==(t=oi(t,e))||delete t[ne(ni(e))]},ci=Math.floor;var ui=function(t,e){var r="";if(!t||e<1||e>9007199254740991)return r;do{e%2&&(r+=t),(e=ci(e/2))&&(t+=t)}while(e);return r},li=Ho("length"),fi="\\ud800-\\udfff",hi="["+fi+"]",di="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",pi="\\ud83c[\\udffb-\\udfff]",vi="[^"+fi+"]",gi="(?:\\ud83c[\\udde6-\\uddff]){2}",yi="[\\ud800-\\udbff][\\udc00-\\udfff]",bi="(?:"+di+"|"+pi+")"+"?",_i="[\\ufe0e\\ufe0f]?",mi=_i+bi+("(?:\\u200d(?:"+[vi,gi,yi].join("|")+")"+_i+bi+")*"),ji="(?:"+[vi+di+"?",di,gi,yi,hi].join("|")+")",wi=RegExp(pi+"(?="+pi+")|"+ji+mi,"g");var Pi=function(t){for(var e=wi.lastIndex=0;wi.test(t);)++e;return e};var Oi=function(t){return Ur(t)?Pi(t):li(t)},Si=Math.ceil;var Ti=function(t,e){var r=(e=void 0===e?" ":te(e)).length;if(r<2)return r?ui(e,t):e;var n=ui(e,Si(t/Oi(e)));return Ur(e)?Rr(rn(n),0,t).join(""):n.slice(0,t)};var Ai=function(t,e,r){t=ee(t);var n=(e=Ne(e))?Oi(t):0;return e&&n<e?Ti(e-n,r)+t:t};var ki=function(t,e){return null==t||si(t,e)},xi=class{constructor(t){j(this,"_cache",new se),j(this,"_keepHotUntapDebounce"),C(this,t)}get type(){return"Theatre_SheetObject_PublicAPI"}get props(){return I(this).propsP}get sheet(){return I(this).sheet.publicApi}get project(){return I(this).sheet.project.publicApi}get address(){return v({},I(this).address)}_valuesPrism(){return this._cache.get("_valuesPrism",(()=>{const t=I(this);return(0,ke.prism)((()=>(0,ke.val)(t.getValues().getValue())))}))}onValuesChange(t,e){return wc(this._valuesPrism(),t,e)}get value(){const t=this._valuesPrism();if(!t.isHot){null!=this._keepHotUntapDebounce&&this._keepHotUntapDebounce.flush();const e=t.keepHot();this._keepHotUntapDebounce=ri((()=>{e(),this._keepHotUntapDebounce=void 0}),5e3)}return this._keepHotUntapDebounce&&this._keepHotUntapDebounce(),t.getValue()}set initialValue(t){I(this).setInitialValue(t)}};function Di(t){const e=new WeakMap;return r=>(e.has(r)||e.set(r,t(r)),e.get(r))}function Ii(t){return"compound"===t.type||"enum"===t.type}function Ci(t,e){if(!t)return;const[r,...n]=e;if(void 0===r)return t;if(!Ii(t))return;return Ci("enum"===t.type?t.cases[r]:t.props[r],n)}var Bi=Di((t=>{if("enum"===t.type)throw new Error("Not implemented yet for enums");for(const e in t.props){const r=t.props[e];if(!Ii(r))return!0;if(Bi(r))return!0}return!1})),Ei=class{constructor(t,e,r){this.sheet=t,this.template=e,this.nativeObject=r,j(this,"$$isPointerToPrismProvider",!0),j(this,"address"),j(this,"publicApi"),j(this,"_initialValue",new Ae.Atom({})),j(this,"_cache",new se),j(this,"_logger"),j(this,"_internalUtilCtx"),this._logger=t._logger.named("SheetObject",e.address.objectKey),this._logger._trace("creating object"),this._internalUtilCtx={logger:this._logger.utilFor.internal()},this.address=g(v({},e.address),{sheetInstanceId:t.address.sheetInstanceId}),this.publicApi=new xi(this)}get type(){return"Theatre_SheetObject"}getValues(){return this._cache.get("getValues()",(()=>(0,Ae.prism)((()=>{const t=Oe((0,Ae.val)(this.template.getDefaultValues()),(0,Ae.val)(this._initialValue.pointer),Ae.prism.memo("withInitialCache",(()=>new WeakMap),[]));let e,r=Oe(t,(0,Ae.val)(this.template.getStaticValues()),Ae.prism.memo("withStatics",(()=>new WeakMap),[]));{const t=Ae.prism.memo("seq",(()=>this.getSequencedValues()),[]),n=Ae.prism.memo("withSeqsCache",(()=>new WeakMap),[]);e=(0,Ae.val)((0,Ae.val)(t));r=Oe(r,e,n)}return((t,e)=>{const r=Te.prism.memo(t,(()=>new Te.Atom(e)),[]);return r.set(e),r})("finalAtom",r).pointer}))))}getValueByPointer(t){const e=(0,Ae.val)(this.getValues()),{path:r}=(0,Ae.getPointerParts)(t);return(0,Ae.val)(Se(e,r))}pointerToPrism(t){const{path:e}=(0,Ae.getPointerParts)(t);return(0,Ae.prism)((()=>{const t=(0,Ae.val)(this.getValues());return(0,Ae.val)(Se(t,e))}))}getSequencedValues(){return(0,Ae.prism)((()=>{const t=Ae.prism.memo("tracksToProcess",(()=>this.template.getArrayOfValidSequenceTracks()),[]),e=(0,Ae.val)(t),r=new Ae.Atom({}),n=(0,Ae.val)(this.template.configPointer);return Ae.prism.effect("processTracks",(()=>{const t=[];for(const{trackId:o,pathToProp:i}of e){const e=this._trackIdToPrism(o),a=Ci(n,i),s=a.deserializeAndSanitize,c=a.interpolate,u=()=>{const t=e.getValue();if(!t)return r.setByPointer((t=>Se(t,i)),void 0);const n=s(t.left),o=void 0===n?a.default:n;if(void 0===t.right)return r.setByPointer((t=>Se(t,i)),o);const u=s(t.right),l=void 0===u?a.default:u;return r.setByPointer((t=>Se(t,i)),c(o,l,t.progression))},l=e.onStale(u);u(),t.push(l)}return()=>{for(const e of t)e()}}),[n,...e]),r.pointer}))}_trackIdToPrism(t){const e=this.template.project.pointers.historic.sheetsById[this.address.sheetId].sequence.tracksByObject[this.address.objectKey].trackData[t],r=this.sheet.getSequence().positionPrism;return je(this._internalUtilCtx,e,r)}get propsP(){return this._cache.get("propsP",(()=>(0,Ae.pointer)({root:this,path:[]})))}validateValue(t,e){}setInitialValue(t){this.validateValue(this.propsP,t),this._initialValue.set(t)}};function Mi(t){return function(e,r){return t(e,r())}}var Fi={_hmm:Vi(524),_todo:Vi(522),_error:Vi(521),errorDev:Vi(529),errorPublic:Vi(545),_kapow:Vi(268),_warn:Vi(265),warnDev:Vi(273),warnPublic:Vi(289),_debug:Vi(137),debugDev:Vi(145),_trace:Vi(73),traceDev:Vi(81)};function Vi(t){return Object.freeze({audience:zi(t,8)?"internal":zi(t,16)?"dev":"public",category:zi(t,4)?"troubleshooting":zi(t,2)?"todo":"general",level:zi(t,512)?512:zi(t,256)?256:zi(t,128)?128:64})}function zi(t,e){return(t&e)===e}function Ri(t,e){return(32==(32&e)||(16==(16&e)?t.dev:8==(8&e)&&t.internal))&&t.min<=e}var Ni={loggingConsoleStyle:!0,loggerConsoleStyle:!0,includes:Object.freeze({internal:!1,dev:!1,min:256}),filtered:function(){},include:function(){return{}},create:null,creatExt:null,named(t,e,r){return this.create({names:[...t.names,{name:e,key:r}]})},style:{bold:void 0,italic:void 0,cssMemo:new Map([["",""]]),collapseOnRE:/[a-z- ]+/g,color:void 0,collapsed(t){if(t.length<5)return t;const e=t.replace(this.collapseOnRE,"");return this.cssMemo.has(e)||this.cssMemo.set(e,this.css(t)),e},css(t){var e,r,n,o;const i=this.cssMemo.get(t);if(i)return i;let a="color:".concat(null!=(r=null==(e=this.color)?void 0:e.call(this,t))?r:"hsl(".concat((t.charCodeAt(0)+t.charCodeAt(t.length-1))%360,", 100%, 60%)"));return(null==(n=this.bold)?void 0:n.test(t))&&(a+=";font-weight:600"),(null==(o=this.italic)?void 0:o.test(t))&&(a+=";font-style:italic"),this.cssMemo.set(t,a),a}}};function Ui(t=console,e={}){const r=g(v({},Ni),{includes:v({},Ni.includes)}),n={styled:$i.bind(r,t),noStyle:Ki.bind(r,t)},o=Li.bind(r);function i(){return r.loggingConsoleStyle&&r.loggerConsoleStyle?n.styled:n.noStyle}return r.create=i(),{configureLogger(t){var e;"console"===t?(r.loggerConsoleStyle=Ni.loggerConsoleStyle,r.create=i()):"console"===t.type?(r.loggerConsoleStyle=null!=(e=t.style)?e:Ni.loggerConsoleStyle,r.create=i()):"keyed"===t.type?(r.creatExt=e=>t.keyed(e.names),r.create=o):"named"===t.type&&(r.creatExt=qi.bind(null,t.named),r.create=o)},configureLogging(t){var e,n,o,a,s;r.includes.dev=null!=(e=t.dev)?e:Ni.includes.dev,r.includes.internal=null!=(n=t.internal)?n:Ni.includes.internal,r.includes.min=null!=(o=t.min)?o:Ni.includes.min,r.include=null!=(a=t.include)?a:Ni.include,r.loggingConsoleStyle=null!=(s=t.consoleStyle)?s:Ni.loggingConsoleStyle,r.create=i()},getLogger(){return r.create({names:[]})}}}function qi(t,e){const r=[];for(let{name:n,key:o}of e.names)r.push(null==o?n:"".concat(n," (").concat(o,")"));return t(r)}function Li(t){const e=v(v({},this.includes),this.include(t)),r=this.filtered,n=this.named.bind(this,t),o=this.creatExt(t),i=Ri(e,524),a=Ri(e,522),s=Ri(e,521),c=Ri(e,529),u=Ri(e,545),l=Ri(e,265),f=Ri(e,268),h=Ri(e,273),d=Ri(e,289),p=Ri(e,137),g=Ri(e,145),y=Ri(e,73),b=Ri(e,81),_=i?o.error.bind(o,Fi._hmm):r.bind(t,524),m=a?o.error.bind(o,Fi._todo):r.bind(t,522),j=s?o.error.bind(o,Fi._error):r.bind(t,521),w=c?o.error.bind(o,Fi.errorDev):r.bind(t,529),P=u?o.error.bind(o,Fi.errorPublic):r.bind(t,545),O=f?o.warn.bind(o,Fi._kapow):r.bind(t,268),S=l?o.warn.bind(o,Fi._warn):r.bind(t,265),T=h?o.warn.bind(o,Fi.warnDev):r.bind(t,273),A=d?o.warn.bind(o,Fi.warnPublic):r.bind(t,273),k=p?o.debug.bind(o,Fi._debug):r.bind(t,137),x=g?o.debug.bind(o,Fi.debugDev):r.bind(t,145),D=y?o.trace.bind(o,Fi._trace):r.bind(t,73),I=b?o.trace.bind(o,Fi.traceDev):r.bind(t,81),C={_hmm:_,_todo:m,_error:j,errorDev:w,errorPublic:P,_kapow:O,_warn:S,warnDev:T,warnPublic:A,_debug:k,debugDev:x,_trace:D,traceDev:I,lazy:{_hmm:i?Mi(_):_,_todo:a?Mi(m):m,_error:s?Mi(j):j,errorDev:c?Mi(w):w,errorPublic:u?Mi(P):P,_kapow:f?Mi(O):O,_warn:l?Mi(S):S,warnDev:h?Mi(T):T,warnPublic:d?Mi(A):A,_debug:p?Mi(k):k,debugDev:g?Mi(x):x,_trace:y?Mi(D):D,traceDev:b?Mi(I):I},named:n,utilFor:{internal(){return{debug:C._debug,error:C._error,warn:C._warn,trace:C._trace,named(t,e){return C.named(t,e).utilFor.internal()}}},dev(){return{debug:C.debugDev,error:C.errorDev,warn:C.warnDev,trace:C.traceDev,named(t,e){return C.named(t,e).utilFor.dev()}}},public(){return{error:C.errorPublic,warn:C.warnPublic,debug(t,e){C._warn('(public "debug" filtered out) '.concat(t),e)},trace(t,e){C._warn('(public "trace" filtered out) '.concat(t),e)},named(t,e){return C.named(t,e).utilFor.public()}}}}};return C}function $i(t,e){const r=v(v({},this.includes),this.include(e)),n=[];let o="";for(let c=0;c<e.names.length;c++){const{name:t,key:r}=e.names[c];if(o+=" %c".concat(t),n.push(this.style.css(t)),null!=r){const t="%c#".concat(r);o+=t,n.push(this.style.css(t))}}const i=this.filtered,a=this.named.bind(this,e),s=[o,...n];return Wi(i,e,r,t,s,function(t){const e=t.slice(0);for(let r=1;r<e.length;r++)e[r]+=";background-color:#e0005a;padding:2px;color:white";return e}(s),a)}function Ki(t,e){const r=v(v({},this.includes),this.include(e));let n="";for(let i=0;i<e.names.length;i++){const{name:t,key:r}=e.names[i];n+=" ".concat(t),null!=r&&(n+="#".concat(r))}const o=[n];return Wi(this.filtered,e,r,t,o,o,this.named.bind(this,e))}function Wi(t,e,r,n,o,i,a){const s=Ri(r,524),c=Ri(r,522),u=Ri(r,521),l=Ri(r,529),f=Ri(r,545),h=Ri(r,265),d=Ri(r,268),p=Ri(r,273),v=Ri(r,289),g=Ri(r,137),y=Ri(r,145),b=Ri(r,73),_=Ri(r,81),m=s?n.error.bind(n,...o):t.bind(e,524),j=c?n.error.bind(n,...o):t.bind(e,522),w=u?n.error.bind(n,...o):t.bind(e,521),P=l?n.error.bind(n,...o):t.bind(e,529),O=f?n.error.bind(n,...o):t.bind(e,545),S=d?n.warn.bind(n,...i):t.bind(e,268),T=h?n.warn.bind(n,...o):t.bind(e,265),A=p?n.warn.bind(n,...o):t.bind(e,273),k=v?n.warn.bind(n,...o):t.bind(e,273),x=g?n.info.bind(n,...o):t.bind(e,137),D=y?n.info.bind(n,...o):t.bind(e,145),I=b?n.debug.bind(n,...o):t.bind(e,73),C=_?n.debug.bind(n,...o):t.bind(e,81),B={_hmm:m,_todo:j,_error:w,errorDev:P,errorPublic:O,_kapow:S,_warn:T,warnDev:A,warnPublic:k,_debug:x,debugDev:D,_trace:I,traceDev:C,lazy:{_hmm:s?Mi(m):m,_todo:c?Mi(j):j,_error:u?Mi(w):w,errorDev:l?Mi(P):P,errorPublic:f?Mi(O):O,_kapow:d?Mi(S):S,_warn:h?Mi(T):T,warnDev:p?Mi(A):A,warnPublic:v?Mi(k):k,_debug:g?Mi(x):x,debugDev:y?Mi(D):D,_trace:b?Mi(I):I,traceDev:_?Mi(C):C},named:a,utilFor:{internal(){return{debug:B._debug,error:B._error,warn:B._warn,trace:B._trace,named(t,e){return B.named(t,e).utilFor.internal()}}},dev(){return{debug:B.debugDev,error:B.errorDev,warn:B.warnDev,trace:B.traceDev,named(t,e){return B.named(t,e).utilFor.dev()}}},public(){return{error:B.errorPublic,warn:B.warnPublic,debug(t,e){B._warn('(public "debug" filtered out) '.concat(t),e)},trace(t,e){B._warn('(public "trace" filtered out) '.concat(t),e)},named(t,e){return B.named(t,e).utilFor.public()}}}}};return B}var Hi=Ui(console,{_debug:function(){},_error:function(){}});Hi.configureLogging({dev:!0,min:64});var Gi=Hi.getLogger().named("Theatre.js (default logger)").utilFor.dev(),Ji=new WeakMap;function Xi(t,e,r){for(const[n,o]of Object.entries(e.props))if(!Ii(o)){const e=[...t,n];r.set(JSON.stringify(e),r.size),Yi(e,o,r)}for(const[n,o]of Object.entries(e.props))if(Ii(o)){const e=[...t,n];r.set(JSON.stringify(e),r.size),Yi(e,o,r)}}function Yi(t,e,r){if("compound"===e.type)Xi(t,e,r);else{if("enum"===e.type)throw new Error("Enums aren't supported yet");r.set(JSON.stringify(t),r.size)}}function Qi(t){return"object"==typeof t&&null!==t&&0===Object.keys(t).length}var Zi=class{constructor(t,e,r,n,o){this.sheetTemplate=t,j(this,"address"),j(this,"type","Theatre_SheetObjectTemplate"),j(this,"_config"),j(this,"_temp_actions_atom"),j(this,"_cache",new se),j(this,"project"),j(this,"pointerToSheetState"),j(this,"pointerToStaticOverrides"),this.address=g(v({},t.address),{objectKey:e}),this._config=new ce.Atom(n),this._temp_actions_atom=new ce.Atom(o),this.project=t.project,this.pointerToSheetState=this.sheetTemplate.project.pointers.historic.sheetsById[this.address.sheetId],this.pointerToStaticOverrides=this.pointerToSheetState.staticOverrides.byObject[this.address.objectKey]}get staticConfig(){return this._config.get()}get configPointer(){return this._config.pointer}get _temp_actions(){return this._temp_actions_atom.get()}get _temp_actionsPointer(){return this._temp_actions_atom.pointer}createInstance(t,e,r){return this._config.set(r),new Ei(t,this,e)}reconfigure(t){this._config.set(t)}_temp_setActions(t){this._temp_actions_atom.set(t)}getDefaultValues(){return this._cache.get("getDefaultValues()",(()=>(0,ce.prism)((()=>function(t){return be(t)}((0,ce.val)(this.configPointer))))))}getStaticValues(){return this._cache.get("getStaticValues",(()=>(0,ce.prism)((()=>{var t;const e=null!=(t=(0,ce.val)(this.pointerToStaticOverrides))?t:{};return(0,ce.val)(this.configPointer).deserializeAndSanitize(e)||{}}))))}getArrayOfValidSequenceTracks(){return this._cache.get("getArrayOfValidSequenceTracks",(()=>(0,ce.prism)((()=>{const t=this.project.pointers.historic.sheetsById[this.address.sheetId],e=(0,ce.val)(t.sequence.tracksByObject[this.address.objectKey].trackIdByPropPath);if(!e)return B;const r=[];if(!e)return B;const n=(0,ce.val)(this.configPointer),o=Object.entries(e);for(const[a,s]of o){const t=ta(a);if(!t)continue;const e=Ci(n,t);e&&!Ii(e)&&r.push({pathToProp:t,trackId:s})}const i=function(t){const e=Ji.get(t);if(e)return e;const r=new Map;return Ji.set(t,r),Xi([],t,r),r}(n);return r.sort(((t,e)=>{const r=t.pathToProp,n=e.pathToProp;return i.get(JSON.stringify(r))>i.get(JSON.stringify(n))?1:-1})),0===r.length?B:r}))))}getMapOfValidSequenceTracks_forStudio(){return this._cache.get("getMapOfValidSequenceTracks_forStudio",(()=>(0,ce.prism)((()=>{const t=(0,ce.val)(this.getArrayOfValidSequenceTracks());let e={};for(const{pathToProp:r,trackId:n}of t)ge(e,r,n);return e}))))}getStaticButNotSequencedOverrides(){return this._cache.get("getStaticButNotSequencedOverrides",(()=>(0,ce.prism)((()=>{const t=(0,ce.val)(this.getStaticValues()),e=(0,ce.val)(this.getArrayOfValidSequenceTracks()),r=yo(t);for(const{pathToProp:n}of e){ki(r,n);let t=n.slice(0,-1);for(;t.length>0;){if(!Qi(ae(r,t)))break;ki(r,t),t=t.slice(0,-1)}}return Qi(r)?void 0:r}))))}getDefaultsAtPointer(t){const{path:e}=(0,ce.getPointerParts)(t);return ae(this.getDefaultValues().getValue(),e)}};function ta(t){try{return JSON.parse(t)}catch(e){return void Gi.warn("property ".concat(JSON.stringify(t)," cannot be parsed. Skipping."))}}var ea=r(4771),ra=Di((t=>JSON.stringify(t)));m(O());var na=class extends Error{},oa=class extends na{},ia=r(4771),aa=r(4771),sa=r(4771),ca=r(4771);function ua(){let t,e;const r=new Promise(((r,o)=>{t=t=>{r(t),n.status="resolved"},e=t=>{o(t),n.status="rejected"}})),n={resolve:t,reject:e,promise:r,status:"pending"};return n}var la=()=>{},fa=r(4771),ha=class{constructor(){j(this,"_stopPlayCallback",la),j(this,"_state",new fa.Atom({position:0,playing:!1})),j(this,"statePointer"),this.statePointer=this._state.pointer}destroy(){}pause(){this._stopPlayCallback(),this.playing=!1,this._stopPlayCallback=la}gotoPosition(t){this._updatePositionInState(t)}_updatePositionInState(t){this._state.setByPointer((t=>t.position),t)}getCurrentPosition(){return this._state.get().position}get playing(){return this._state.get().playing}set playing(t){this._state.setByPointer((t=>t.playing),t)}play(t,e,r,n,o){this.playing&&this.pause(),this.playing=!0;const i=e[1]-e[0];{const t=this.getCurrentPosition();t<e[0]||t>e[1]?"normal"===n||"alternate"===n?this._updatePositionInState(e[0]):"reverse"!==n&&"alternateReverse"!==n||this._updatePositionInState(e[1]):"normal"===n||"alternate"===n?t===e[1]&&this._updatePositionInState(e[0]):t===e[0]&&this._updatePositionInState(e[1])}const a=ua(),s=o.time,c=i*t;let u=this.getCurrentPosition()-e[0];"reverse"!==n&&"alternateReverse"!==n||(u=e[1]-this.getCurrentPosition());const l=o=>{const l=Math.max(o-s,0)/1e3,h=Math.min(l*r+u,c);if(h!==c){const t=Math.floor(h/i);let r=h/i%1*i;if("normal"!==n)if("reverse"===n)r=i-r;else{const e=t%2==0;"alternate"===n?e||(r=i-r):e&&(r=i-r)}this._updatePositionInState(r+e[0]),f()}else{if("normal"===n)this._updatePositionInState(e[1]);else if("reverse"===n)this._updatePositionInState(e[0]);else{const r=(t-1)%2==0;"alternate"===n?r?this._updatePositionInState(e[1]):this._updatePositionInState(e[0]):r?this._updatePositionInState(e[0]):this._updatePositionInState(e[1])}this.playing=!1,a.resolve(!0)}};this._stopPlayCallback=()=>{o.offThisOrNextTick(l),o.offNextTick(l),this.playing&&a.resolve(!1)};const f=()=>o.onNextTick(l);return o.onThisOrNextTick(l),a.promise}playDynamicRange(t,e){this.playing&&this.pause(),this.playing=!0;const r=ua(),n=t.keepHot();r.promise.then(n,n);let o=e.time;const i=e=>{const r=Math.max(e-o,0);o=e;const n=r/1e3,i=this.getCurrentPosition(),s=t.getValue();if(i<s[0]||i>s[1])this.gotoPosition(s[0]);else{let t=i+n;t>s[1]&&(t=s[0]+(t-s[1])),this.gotoPosition(t)}a()};this._stopPlayCallback=()=>{e.offThisOrNextTick(i),e.offNextTick(i),r.resolve(!1)};const a=()=>e.onNextTick(i);return e.onThisOrNextTick(i),r.promise}},da=r(4771),pa="__TheatreJS_CoreBundle",va=t=>(...e)=>{var r;switch(t){case"success":case"info":Gi.debug(e.slice(0,2).join("\n"));break;case"warning":Gi.warn(e.slice(0,2).join("\n"))}return"undefined"!=typeof window?null==(r=window.__TheatreJS_Notifications)?void 0:r.notify[t](...e):void 0},ga={warning:va("warning"),success:va("success"),info:va("info"),error:va("error")};"undefined"!=typeof window&&(window.addEventListener("error",(t=>{ga.error("An error occurred","<pre>".concat(t.message,"</pre>\n\nSee **console** for details."))})),window.addEventListener("unhandledrejection",(t=>{ga.error("An error occurred","<pre>".concat(t.reason,"</pre>\n\nSee **console** for details."))})));var ya,ba=class{constructor(t,e,r){this._decodedBuffer=t,this._audioContext=e,this._nodeDestination=r,j(this,"_mainGain"),j(this,"_state",new da.Atom({position:0,playing:!1})),j(this,"statePointer"),j(this,"_stopPlayCallback",la),this.statePointer=this._state.pointer,this._mainGain=this._audioContext.createGain(),this._mainGain.connect(this._nodeDestination)}playDynamicRange(t,e){const r=ua();let n;this._playing&&this.pause(),this._playing=!0;const o=()=>{null==n||n(),n=this._loopInRange(t.getValue(),e).stop},i=t.onStale(o);return o(),this._stopPlayCallback=()=>{null==n||n(),i(),r.resolve(!1)},r.promise}_loopInRange(t,e){let r=this.getCurrentPosition();const n=t[1]-t[0];(r<t[0]||r>t[1]||r===t[1])&&this._updatePositionInState(t[0]),r=this.getCurrentPosition();const o=this._audioContext.createBufferSource();o.buffer=this._decodedBuffer,o.connect(this._mainGain),o.playbackRate.value=1,o.loop=!0,o.loopStart=t[0],o.loopEnd=t[1];const i=e.time;let a=r-t[0];o.start(0,r);const s=e=>{let r=(1*(Math.max(e-i,0)/1e3)+a)/n%1*n;this._updatePositionInState(r+t[0]),c()},c=()=>e.onNextTick(s);e.onThisOrNextTick(s);return{stop:()=>{o.stop(),o.disconnect(),e.offThisOrNextTick(s),e.offNextTick(s)}}}get _playing(){return this._state.get().playing}set _playing(t){this._state.setByPointer((t=>t.playing),t)}destroy(){}pause(){this._stopPlayCallback(),this._playing=!1,this._stopPlayCallback=la}gotoPosition(t){this._updatePositionInState(t)}_updatePositionInState(t){this._state.reduce((e=>g(v({},e),{position:t})))}getCurrentPosition(){return this._state.get().position}play(t,e,r,n,o){this._playing&&this.pause(),this._playing=!0;let i=this.getCurrentPosition();const a=e[1]-e[0];if("normal"!==n)throw new oa('Audio-controlled sequences can only be played in the "normal" direction. '+"'".concat(n,"' given."));(i<e[0]||i>e[1]||i===e[1])&&this._updatePositionInState(e[0]),i=this.getCurrentPosition();const s=ua(),c=this._audioContext.createBufferSource();c.buffer=this._decodedBuffer,c.connect(this._mainGain),c.playbackRate.value=r,t>1e3&&(ga.warning("Can't play sequences with audio more than 1000 times","The sequence will still play, but only 1000 times. The `iterationCount: ".concat(t,"` provided to `sequence.play()`\nis too high for a sequence with audio.\n\nTo fix this, either set `iterationCount` to a lower value, or remove the audio from the sequence."),[{url:"https://www.theatrejs.com/docs/latest/manual/audio",title:"Using Audio"},{url:"https://www.theatrejs.com/docs/latest/api/core#sequence.attachaudio",title:"Audio API"}]),t=1e3),t>1&&(c.loop=!0,c.loopStart=e[0],c.loopEnd=e[1]);const u=o.time;let l=i-e[0];const f=a*t;c.start(0,i,f-l);const h=t=>{const n=Math.max(t-u,0)/1e3,o=Math.min(n*r+l,f);if(o!==f){let t=o/a%1*a;this._updatePositionInState(t+e[0]),p()}else this._updatePositionInState(e[1]),this._playing=!1,d(),s.resolve(!0)},d=()=>{c.stop(),c.disconnect()};this._stopPlayCallback=()=>{d(),o.offThisOrNextTick(h),o.offNextTick(h),this._playing&&s.resolve(!1)};const p=()=>o.onNextTick(h);return o.onThisOrNextTick(h),s.promise}},_a=r(4771),ma=0;function ja(t){var e;const r=new _a.Ticker({onActive(){var e;null==(e=null==t?void 0:t.start)||e.call(t)},onDormant(){var e;null==(e=null==t?void 0:t.stop)||e.call(t)}}),n={tick:t=>{r.tick(t)},id:ma++,name:null!=(e=null==t?void 0:t.name)?e:"CustomRafDriver-".concat(ma),type:"Theatre_RafDriver_PublicAPI"};return C(n,{type:"Theatre_RafDriver_PrivateAPI",publicApi:n,ticker:r,start:null==t?void 0:t.start,stop:null==t?void 0:t.stop}),n}function wa(){return ya||function(t){if(ya)throw new Error("`setCoreRafDriver()` is already called.");const e=I(t);ya=e}(function(){let t=null;const e=ja({name:"DefaultCoreRafDriver",start:()=>{if("undefined"!=typeof window){const r=n=>{e.tick(n),t=window.requestAnimationFrame(r)};t=window.requestAnimationFrame(r)}else e.tick(0),setTimeout((()=>e.tick(1)),0)},stop:()=>{"undefined"!=typeof window&&null!==t&&window.cancelAnimationFrame(t)}});return e}()),ya}function Pa(){return wa().ticker}var Oa=class{get type(){return"Theatre_Sequence_PublicAPI"}constructor(t){C(this,t)}play(t){const e=I(this);if(e._project.isReady()){const r=(null==t?void 0:t.rafDriver)?I(t.rafDriver).ticker:Pa();return e.play(null!=t?t:{},r)}{0;const t=ua();return t.resolve(!0),t.promise}}pause(){I(this).pause()}get position(){return I(this).position}set position(t){I(this).position=t}__experimental_getKeyframes(t){return I(this).getKeyframesOfSimpleProp(t)}async attachAudio(t){const{audioContext:e,destinationNode:r,decodedBuffer:n,gainNode:o}=await async function(t){function e(){if(t.audioContext)return Promise.resolve(t.audioContext);const e=new AudioContext;return"running"===e.state||"undefined"==typeof window?Promise.resolve(e):new Promise((t=>{const r=()=>{e.resume().catch((t=>{console.error(t)}))},n=["mousedown","keydown","touchstart"],o={capture:!0,passive:!1};n.forEach((t=>{window.addEventListener(t,r,o)})),e.addEventListener("statechange",(()=>{"running"===e.state&&(n.forEach((t=>{window.removeEventListener(t,r,o)})),t(e))}))}))}async function r(){if(t.source instanceof AudioBuffer)return t.source;const e=ua();if("string"!=typeof t.source)throw new Error("Error validating arguments to sequence.attachAudio(). args.source must either be a string or an instance of AudioBuffer.");let r,o;try{r=await fetch(t.source)}catch(a){throw console.error(a),new Error("Could not fetch '".concat(t.source,"'. Network error logged above."))}try{o=await r.arrayBuffer()}catch(a){throw console.error(a),new Error("Could not read '".concat(t.source,"' as an arrayBuffer."))}let i;(await n).decodeAudioData(o,e.resolve,e.reject);try{i=await e.promise}catch(a){throw console.error(a),new Error("Could not decode ".concat(t.source," as an audio file."))}return i}const n=e(),o=r(),[i,a]=await Promise.all([n,o]),s=t.destinationNode||i.destination,c=i.createGain();return c.connect(s),{audioContext:i,decodedBuffer:a,gainNode:c,destinationNode:s}}(t),i=new ba(n,e,o);return I(this).replacePlaybackController(i),{audioContext:e,destinationNode:r,decodedBuffer:n,gainNode:o}}get pointer(){return I(this).pointer}};Ta("Theatre_Project"),Ta("Theatre_Sheet"),Ta("Theatre_SheetTemplate");var Sa=Ta("Theatre_SheetObject");Ta("Theatre_SheetObjectTemplate"),Ta("Theatre_Project_PublicAPI"),Ta("Theatre_Sheet_PublicAPI"),Ta("Theatre_SheetObject_PublicAPI");function Ta(t){return e=>"object"==typeof e&&!!e&&e.type===t}var Aa=class{constructor(t,e,r,n,o){this._project=t,this._sheet=e,this._lengthD=r,this._subUnitsPerUnitD=n,j(this,"address"),j(this,"publicApi"),j(this,"_playbackControllerBox"),j(this,"_prismOfStatePointer"),j(this,"_positionD"),j(this,"_positionFormatterD"),j(this,"_playableRangeD"),j(this,"pointer",(0,sa.pointer)({root:this,path:[]})),j(this,"$$isPointerToPrismProvider",!0),j(this,"_logger"),j(this,"closestGridPosition",(t=>{const e=1/this.subUnitsPerUnit;return parseFloat((Math.round(t/e)*e).toFixed(3))})),this._logger=t._logger.named("Sheet",e.address.sheetId).named("Instance",e.address.sheetInstanceId),this.address=g(v({},this._sheet.address),{sequenceName:"default"}),this.publicApi=new Oa(this),this._playbackControllerBox=new aa.Atom(null!=o?o:new ha),this._prismOfStatePointer=(0,ca.prism)((()=>this._playbackControllerBox.prism.getValue().statePointer)),this._positionD=(0,ca.prism)((()=>{const t=this._prismOfStatePointer.getValue();return(0,ca.val)(t.position)})),this._positionFormatterD=(0,ca.prism)((()=>{const t=(0,ca.val)(this._subUnitsPerUnitD);return new ka(t)}))}pointerToPrism(t){const{path:e}=(0,ia.getPointerParts)(t);if(0===e.length)return(0,ca.prism)((()=>({length:(0,ca.val)(this.pointer.length),playing:(0,ca.val)(this.pointer.playing),position:(0,ca.val)(this.pointer.position)})));if(e.length>1)return(0,ca.prism)((()=>{}));const[r]=e;return"length"===r?this._lengthD:"position"===r?this._positionD:"playing"===r?(0,ca.prism)((()=>(0,ca.val)(this._prismOfStatePointer.getValue().playing))):(0,ca.prism)((()=>{}))}getKeyframesOfSimpleProp(t){const{path:e,root:r}=(0,ia.getPointerParts)(t);if(!Sa(r))throw new oa("Argument prop must be a pointer to a SheetObject property");const n=(0,ca.val)(this._project.pointers.historic.sheetsById[this._sheet.address.sheetId].sequence.tracksByObject[r.address.objectKey]);if(!n)return[];const{trackData:o,trackIdByPropPath:i}=n,a=i[ra(e)];if(!a)return[];const s=o[a];return s?s.keyframes:[]}get positionFormatter(){return this._positionFormatterD.getValue()}get prismOfStatePointer(){return this._prismOfStatePointer}get length(){return this._lengthD.getValue()}get positionPrism(){return this._positionD}get position(){return this._playbackControllerBox.get().getCurrentPosition()}get subUnitsPerUnit(){return this._subUnitsPerUnitD.getValue()}get positionSnappedToGrid(){return this.closestGridPosition(this.position)}set position(t){let e=t;this.pause(),e>this.length&&(e=this.length);const r=this.length;this._playbackControllerBox.get().gotoPosition(e>r?r:e)}getDurationCold(){return this._lengthD.getValue()}get playing(){return(0,ca.val)(this._playbackControllerBox.get().statePointer.playing)}_makeRangeFromSequenceTemplate(){return(0,ca.prism)((()=>[0,(0,ca.val)(this._lengthD)]))}playDynamicRange(t,e){return this._playbackControllerBox.get().playDynamicRange(t,e)}async play(t,e){const r=this.length,n=t&&t.range?t.range:[0,r];const o=t&&"number"==typeof t.iterationCount?t.iterationCount:1;const i=t&&void 0!==t.rate?t.rate:1;const a=t&&t.direction?t.direction:"normal";return await this._play(o,[n[0],n[1]],i,a,e)}_play(t,e,r,n,o){return this._playbackControllerBox.get().play(t,e,r,n,o)}pause(){this._playbackControllerBox.get().pause()}replacePlaybackController(t){this.pause();const e=this._playbackControllerBox.get();this._playbackControllerBox.set(t);const r=e.getCurrentPosition();e.destroy(),t.gotoPosition(r)}},ka=class{constructor(t){this._fps=t}formatSubUnitForGrid(t){const e=t%1,r=1/this._fps;return Math.round(e/r)+"f"}formatFullUnitForGrid(t){let e=t,r="";if(e>=Ia){r+=Math.floor(e/Ia)+"h",e%=Ia}if(e>=Da){r+=Math.floor(e/Da)+"m",e%=Da}if(e>=xa){r+=Math.floor(e/xa)+"s",e%=xa}const n=1/this._fps;if(e>=n){r+=Math.floor(e/n)+"f",e%=n}return 0===r.length?"0s":r}formatForPlayhead(t){let e=t,r="";if(e>=Ia){const t=Math.floor(e/Ia);r+=Ai(t.toString(),2,"0")+"h",e%=Ia}if(e>=Da){const t=Math.floor(e/Da);r+=Ai(t.toString(),2,"0")+"m",e%=Da}else r.length>0&&(r+="00m");if(e>=xa){const t=Math.floor(e/xa);r+=Ai(t.toString(),2,"0")+"s",e%=xa}else r+="00s";const n=1/this._fps;if(e>=n){const t=Math.round(e/n);r+=Ai(t.toString(),2,"0")+"f",e%=n}else if(e/n>.98){r+=Ai(1..toString(),2,"0")+"f",e%=n}else r+="00f";return 0===r.length?"00s00f":r}formatBasic(t){return t.toFixed(2)+"s"}},xa=1,Da=60*xa,Ia=60*Da,Ca={};function Ba(t,e){return t.length<=e?t:t.substr(0,e-3)+"..."}b(Ca,{boolean:()=>ts,compound:()=>qa,file:()=>La,image:()=>Ka,number:()=>Ha,rgba:()=>Ya,string:()=>ns,stringLiteral:()=>is});var Ea=t=>"string"==typeof t?'string("'.concat(Ba(t,10),'")'):"number"==typeof t?"number(".concat(Ba(String(t),10),")"):null===t?"null":void 0===t?"undefined":"boolean"==typeof t?String(t):Array.isArray(t)?"array":"object"==typeof t?"object":"unknown";function Ma(t){return g(v({},t),{toString(){return function(t,{removeAlphaIfOpaque:e=!1}={}){const r=(255*t.a|256).toString(16).slice(1),n=(255*t.r|256).toString(16).slice(1)+(255*t.g|256).toString(16).slice(1)+(255*t.b|256).toString(16).slice(1)+(e&&"ff"===r?"":r);return"#".concat(n)}(this,{removeAlphaIfOpaque:!0})}})}function Fa(t){function e(t){return t>=.0031308?1.055*t**(1/2.4)-.055:12.92*t}return function(t){return Object.fromEntries(Object.entries(t).map((([t,e])=>[t,on(e,0,1)])))}({r:e(t.r),g:e(t.g),b:e(t.b),a:t.a})}function Va(t){function e(t){return t>=.04045?((t+.055)/1.055)**2.4:t/12.92}return{r:e(t.r),g:e(t.g),b:e(t.b),a:t.a}}function za(t){let e=.4122214708*t.r+.5363325363*t.g+.0514459929*t.b,r=.2119034982*t.r+.6806995451*t.g+.1073969566*t.b,n=.0883024619*t.r+.2817188376*t.g+.6299787005*t.b,o=Math.cbrt(e),i=Math.cbrt(r),a=Math.cbrt(n);return{L:.2104542553*o+.793617785*i-.0040720468*a,a:1.9779984951*o-2.428592205*i+.4505937099*a,b:.0259040371*o+.7827717662*i-.808675766*a,alpha:t.a}}var Ra=Symbol("TheatrePropType_Basic");function Na(t){return"object"==typeof t&&!!t&&"TheatrePropType"===t[Ra]}function Ua(t){if("number"==typeof t)return Ha(t);if("boolean"==typeof t)return ts(t);if("string"==typeof t)return ns(t);if("object"==typeof t&&t){if(Na(t))return t;if(Vr(t))return qa(t);throw new oa("This value is not a valid prop type: ".concat(Ea(t)))}throw new oa("This value is not a valid prop type: ".concat(Ea(t)))}var qa=(t,e={})=>{const r=function(t){const e={};for(const r of Object.keys(t)){const n=t[r];Na(n)?e[r]=n:e[r]=Ua(n)}return e}(t),n=new WeakMap;return{type:"compound",props:r,valueType:null,[Ra]:"TheatrePropType",label:e.label,default:ai(r,(t=>t.default)),deserializeAndSanitize:t=>{if("object"!=typeof t||!t)return;if(n.has(t))return n.get(t);const e={};let o=!1;for(const[n,i]of Object.entries(r))if(Object.prototype.hasOwnProperty.call(t,n)){const r=i.deserializeAndSanitize(t[n]);null!=r&&(o=!0,e[n]=r)}return n.set(t,e),o?e:void 0}}},La=(t,e={})=>{return{type:"file",default:{type:"file",id:t},valueType:null,[Ra]:"TheatrePropType",label:e.label,interpolate:(t,r,n)=>{var o;return{type:"file",id:(null!=(o=e.interpolate)?o:rs)(t.id,r.id,n)}},deserializeAndSanitize:$a}},$a=t=>{if(!t)return;let e=!0;return"string"==typeof t.id||[null,void 0].includes(t.id)||(e=!1),"file"!==t.type&&(e=!1),e?t:void 0},Ka=(t,e={})=>{return{type:"image",default:{type:"image",id:t},valueType:null,[Ra]:"TheatrePropType",label:e.label,interpolate:(t,r,n)=>{var o;return{type:"image",id:(null!=(o=e.interpolate)?o:rs)(t.id,r.id,n)}},deserializeAndSanitize:Wa}},Wa=t=>{if(!t)return;let e=!0;return"string"==typeof t.id||[null,void 0].includes(t.id)||(e=!1),"image"!==t.type&&(e=!1),e?t:void 0},Ha=(t,e={})=>{var r;return g(v({type:"number",valueType:0,default:t,[Ra]:"TheatrePropType"},e||{}),{label:e.label,nudgeFn:null!=(r=e.nudgeFn)?r:as,nudgeMultiplier:"number"==typeof e.nudgeMultiplier?e.nudgeMultiplier:void 0,interpolate:Xa,deserializeAndSanitize:Ga(e.range)})},Ga=t=>t?e=>{if("number"==typeof e&&isFinite(e))return on(e,t[0],t[1])}:Ja,Ja=t=>"number"==typeof t&&isFinite(t)?t:void 0,Xa=(t,e,r)=>t+r*(e-t),Ya=(t={r:0,g:0,b:0,a:1},e={})=>{const r={};for(const n of["r","g","b","a"])r[n]=Math.min(Math.max(t[n],0),1);return{type:"rgba",valueType:null,default:Ma(r),[Ra]:"TheatrePropType",label:e.label,interpolate:Za,deserializeAndSanitize:Qa}},Qa=t=>{if(!t)return;let e=!0;for(const n of["r","g","b","a"])Object.prototype.hasOwnProperty.call(t,n)&&"number"==typeof t[n]||(e=!1);if(!e)return;const r={};for(const n of["r","g","b","a"])r[n]=Math.min(Math.max(t[n],0),1);return Ma(r)},Za=(t,e,r)=>{const n=za(Va(t)),o=za(Va(e));return Ma(Fa(function(t){let e=t.L+.3963377774*t.a+.2158037573*t.b,r=t.L-.1055613458*t.a-.0638541728*t.b,n=t.L-.0894841775*t.a-1.291485548*t.b,o=e*e*e,i=r*r*r,a=n*n*n;return{r:4.0767416621*o-3.3077115913*i+.2309699292*a,g:-1.2684380046*o+2.6097574011*i-.3413193965*a,b:-.0041960863*o-.7034186147*i+1.707614701*a,a:t.alpha}}({L:(1-r)*n.L+r*o.L,a:(1-r)*n.a+r*o.a,b:(1-r)*n.b+r*o.b,alpha:(1-r)*n.alpha+r*o.alpha})))},ts=(t,e={})=>{var r;return{type:"boolean",default:t,valueType:null,[Ra]:"TheatrePropType",label:e.label,interpolate:null!=(r=e.interpolate)?r:rs,deserializeAndSanitize:es}},es=t=>"boolean"==typeof t?t:void 0;function rs(t){return t}var ns=(t,e={})=>{var r;return{type:"string",default:t,valueType:null,[Ra]:"TheatrePropType",label:e.label,interpolate:null!=(r=e.interpolate)?r:rs,deserializeAndSanitize:os}};function os(t){return"string"==typeof t?t:void 0}function is(t,e,r={}){var n,o;return{type:"stringLiteral",default:t,valuesAndLabels:v({},e),[Ra]:"TheatrePropType",valueType:null,as:null!=(n=r.as)?n:"menu",label:r.label,interpolate:null!=(o=r.interpolate)?o:rs,deserializeAndSanitize(t){if("string"==typeof t)return Object.prototype.hasOwnProperty.call(e,t)?t:void 0}}}var as=({config:t,deltaX:e,deltaFraction:r,magnitude:n})=>{var o;const{range:i}=t;return t.nudgeMultiplier||!i||i.includes(1/0)||i.includes(-1/0)?e*n*(null!=(o=t.nudgeMultiplier)?o:1):r*(i[1]-i[0])*n};function ss(t,e){const r=t.replace(/^[\s\/]*/,"").replace(/[\s\/]*$/,"").replace(/\s*\/\s*/g," / ");return r}m(S());var cs,us,ls=class{get type(){return"Theatre_Sheet_PublicAPI"}constructor(t){C(this,t)}object(t,e,r){const n=I(this),o=ss(t),i=n.getObject(o),a=null==r?void 0:r.__actions__THIS_API_IS_UNSTABLE_AND_WILL_CHANGE_IN_THE_NEXT_VERSION;if(i)return a&&i.template._temp_setActions(a),i.publicApi;{const t=qa(e);return n.createObject(o,null,t,a).publicApi}}get sequence(){return I(this).getSequence().publicApi}get project(){return I(this).project.publicApi}get address(){return v({},I(this).address)}detachObject(t){const e=I(this),r=ss(t,'sheet.deleteObject("'.concat(t,'")'));if(!e.getObject(r))return ga.warning("Couldn't delete object \"".concat(r,'"'),'There is no object with key "'.concat(r,'".\n\nTo fix this, make sure you are calling `sheet.deleteObject("').concat(r,'")` with the correct key.')),void console.warn('Object key "'.concat(r,'" does not exist.'));e.deleteObject(r)}},fs=r(4771),hs=class{constructor(t,e){this.template=t,this.instanceId=e,j(this,"_objects",new fs.Atom({})),j(this,"_sequence"),j(this,"address"),j(this,"publicApi"),j(this,"project"),j(this,"objectsP",this._objects.pointer),j(this,"type","Theatre_Sheet"),j(this,"_logger"),this._logger=t.project._logger.named("Sheet",e),this._logger._trace("creating sheet"),this.project=t.project,this.address=g(v({},t.address),{sheetInstanceId:this.instanceId}),this.publicApi=new ls(this)}createObject(t,e,r,n={}){const o=this.template.getObjectTemplate(t,e,r,n).createInstance(this,e,r);return this._objects.setByPointer((e=>e[t]),o),o}getObject(t){return this._objects.get()[t]}deleteObject(t){this._objects.reduce((e=>{const r=v({},e);return delete r[t],r}))}getSequence(){if(!this._sequence){const t=(0,fs.prism)((()=>{const t=(0,fs.val)(this.project.pointers.historic.sheetsById[this.address.sheetId].sequence.length);return ds(t)})),e=(0,fs.prism)((()=>{const t=(0,fs.val)(this.project.pointers.historic.sheetsById[this.address.sheetId].sequence.subUnitsPerUnit);return ps(t)}));this._sequence=new Aa(this.template.project,this,t,e)}return this._sequence}},ds=t=>"number"==typeof t&&isFinite(t)&&t>0?t:10,ps=t=>"number"==typeof t&&ii(t)&&t>=1&&t<=1e3?t:30,vs=class{constructor(t,e){this.project=t,j(this,"type","Theatre_SheetTemplate"),j(this,"address"),j(this,"_instances",new ea.Atom({})),j(this,"instancesP",this._instances.pointer),j(this,"_objectTemplates",new ea.Atom({})),j(this,"objectTemplatesP",this._objectTemplates.pointer),this.address=g(v({},t.address),{sheetId:e})}getInstance(t){let e=this._instances.get()[t];return e||(e=new hs(this,t),this._instances.setByPointer((e=>e[t]),e)),e}getObjectTemplate(t,e,r,n){let o=this._objectTemplates.get()[t];return o||(o=new Zi(this,t,e,r,n),this._objectTemplates.setByPointer((e=>e[t]),o)),o}},gs=r(4771),ys=r(4771),bs=t=>new Promise((e=>setTimeout(e,t)));function _s(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+t+(r.length?" "+r.map((function(t){return"'"+t+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function ms(t){return!!t&&!!t[nc]}function js(t){return!!t&&(function(t){if(!t||"object"!=typeof t)return!1;var e=Object.getPrototypeOf(t);if(null===e)return!0;var r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===oc}(t)||Array.isArray(t)||!!t[rc]||!!t.constructor[rc]||Ts(t)||As(t))}function ws(t,e,r){void 0===r&&(r=!1),0===Ps(t)?(r?Object.keys:ic)(t).forEach((function(n){r&&"symbol"==typeof n||e(n,t[n],t)})):t.forEach((function(r,n){return e(n,r,t)}))}function Ps(t){var e=t[nc];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:Ts(t)?2:As(t)?3:0}function Os(t,e){return 2===Ps(t)?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Ss(t,e,r){var n=Ps(t);2===n?t.set(e,r):3===n?(t.delete(e),t.add(r)):t[e]=r}function Ts(t){return Qs&&t instanceof Map}function As(t){return Zs&&t instanceof Set}function ks(t){return t.o||t.t}function xs(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=ac(t);delete e[nc];for(var r=ic(e),n=0;n<r.length;n++){var o=r[n],i=e[o];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(e[o]={configurable:!0,writable:!0,enumerable:i.enumerable,value:t[o]})}return Object.create(Object.getPrototypeOf(t),e)}function Ds(t,e){return void 0===e&&(e=!1),Cs(t)||ms(t)||!js(t)||(Ps(t)>1&&(t.set=t.add=t.clear=t.delete=Is),Object.freeze(t),e&&ws(t,(function(t,e){return Ds(e,!0)}),!0)),t}function Is(){_s(2)}function Cs(t){return null==t||"object"!=typeof t||Object.isFrozen(t)}function Bs(t){var e=sc[t];return e||_s(18,t),e}function Es(){return us}function Ms(t,e){e&&(Bs("Patches"),t.u=[],t.s=[],t.v=e)}function Fs(t){Vs(t),t.p.forEach(Rs),t.p=null}function Vs(t){t===us&&(us=t.l)}function zs(t){return us={p:[],l:us,h:t,m:!0,_:0}}function Rs(t){var e=t[nc];0===e.i||1===e.i?e.j():e.O=!0}function Ns(t,e){e._=e.p.length;var r=e.p[0],n=void 0!==t&&t!==r;return e.h.g||Bs("ES5").S(e,t,n),n?(r[nc].P&&(Fs(e),_s(4)),js(t)&&(t=Us(e,t),e.l||Ls(e,t)),e.u&&Bs("Patches").M(r[nc],t,e.u,e.s)):t=Us(e,r,[]),Fs(e),e.u&&e.v(e.u,e.s),t!==ec?t:void 0}function Us(t,e,r){if(Cs(e))return e;var n=e[nc];if(!n)return ws(e,(function(o,i){return qs(t,n,e,o,i,r)}),!0),e;if(n.A!==t)return e;if(!n.P)return Ls(t,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var o=4===n.i||5===n.i?n.o=xs(n.k):n.o;ws(3===n.i?new Set(o):o,(function(e,i){return qs(t,n,o,e,i,r)})),Ls(t,o,!1),r&&t.u&&Bs("Patches").R(n,r,t.u,t.s)}return n.o}function qs(t,e,r,n,o,i){if(ms(o)){var a=Us(t,o,i&&e&&3!==e.i&&!Os(e.D,n)?i.concat(n):void 0);if(Ss(r,n,a),!ms(a))return;t.m=!1}if(js(o)&&!Cs(o)){if(!t.h.F&&t._<1)return;Us(t,o),e&&e.A.l||Ls(t,o)}}function Ls(t,e,r){void 0===r&&(r=!1),t.h.F&&t.m&&Ds(e,r)}function $s(t,e){var r=t[nc];return(r?ks(r):t)[e]}function Ks(t,e){if(e in t)for(var r=Object.getPrototypeOf(t);r;){var n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Object.getPrototypeOf(r)}}function Ws(t){t.P||(t.P=!0,t.l&&Ws(t.l))}function Hs(t){t.o||(t.o=xs(t.t))}function Gs(t,e,r){var n=Ts(e)?Bs("MapSet").N(e,r):As(e)?Bs("MapSet").T(e,r):t.g?function(t,e){var r=Array.isArray(t),n={i:r?1:0,A:e?e.A:Es(),P:!1,I:!1,D:{},l:e,t:t,k:null,o:null,j:null,C:!1},o=n,i=cc;r&&(o=[n],i=uc);var a=Proxy.revocable(o,i),s=a.revoke,c=a.proxy;return n.k=c,n.j=s,c}(e,r):Bs("ES5").J(e,r);return(r?r.A:Es()).p.push(n),n}function Js(t){return ms(t)||_s(22,t),function t(e){if(!js(e))return e;var r,n=e[nc],o=Ps(e);if(n){if(!n.P&&(n.i<4||!Bs("ES5").K(n)))return n.t;n.I=!0,r=Xs(e,o),n.I=!1}else r=Xs(e,o);return ws(r,(function(e,o){n&&function(t,e){return 2===Ps(t)?t.get(e):t[e]}(n.t,e)===o||Ss(r,e,t(o))})),3===o?new Set(r):r}(t)}function Xs(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return xs(t)}var Ys="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Qs="undefined"!=typeof Map,Zs="undefined"!=typeof Set,tc="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,ec=Ys?Symbol.for("immer-nothing"):((cs={})["immer-nothing"]=!0,cs),rc=Ys?Symbol.for("immer-draftable"):"__$immer_draftable",nc=Ys?Symbol.for("immer-state"):"__$immer_state",oc=""+Object.prototype.constructor,ic="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,ac=Object.getOwnPropertyDescriptors||function(t){var e={};return ic(t).forEach((function(r){e[r]=Object.getOwnPropertyDescriptor(t,r)})),e},sc={},cc={get:function(t,e){if(e===nc)return t;var r,n,o,i=ks(t);if(!Os(i,e))return r=t,(o=Ks(i,e))?"value"in o?o.value:null===(n=o.get)||void 0===n?void 0:n.call(r.k):void 0;var a=i[e];return t.I||!js(a)?a:a===$s(t.t,e)?(Hs(t),t.o[e]=Gs(t.A.h,a,t)):a},has:function(t,e){return e in ks(t)},ownKeys:function(t){return Reflect.ownKeys(ks(t))},set:function(t,e,r){var n=Ks(ks(t),e);if(null==n?void 0:n.set)return n.set.call(t.k,r),!0;if(!t.P){var o=$s(ks(t),e),i=null==o?void 0:o[nc];if(i&&i.t===r)return t.o[e]=r,t.D[e]=!1,!0;if(function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}(r,o)&&(void 0!==r||Os(t.t,e)))return!0;Hs(t),Ws(t)}return t.o[e]===r&&"number"!=typeof r&&(void 0!==r||e in t.o)||(t.o[e]=r,t.D[e]=!0,!0)},deleteProperty:function(t,e){return void 0!==$s(t.t,e)||e in t.t?(t.D[e]=!1,Hs(t),Ws(t)):delete t.D[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var r=ks(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n?{writable:!0,configurable:1!==t.i||"length"!==e,enumerable:n.enumerable,value:r[e]}:n},defineProperty:function(){_s(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){_s(12)}},uc={};ws(cc,(function(t,e){uc[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}})),uc.deleteProperty=function(t,e){return cc.deleteProperty.call(this,t[0],e)},uc.set=function(t,e,r){return cc.set.call(this,t[0],e,r,t[0])};var lc=function(){function t(t){var e=this;this.g=tc,this.F=!0,this.produce=function(t,r,n){if("function"==typeof t&&"function"!=typeof r){var o=r;r=t;var i=e;return function(t){var e=this;void 0===t&&(t=o);for(var n=arguments.length,a=Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];return i.produce(t,(function(t){var n;return(n=r).call.apply(n,[e,t].concat(a))}))}}var a;if("function"!=typeof r&&_s(6),void 0!==n&&"function"!=typeof n&&_s(7),js(t)){var s=zs(e),c=Gs(e,t,void 0),u=!0;try{a=r(c),u=!1}finally{u?Fs(s):Vs(s)}return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(t){return Ms(s,n),Ns(t,s)}),(function(t){throw Fs(s),t})):(Ms(s,n),Ns(a,s))}if(!t||"object"!=typeof t){if((a=r(t))===ec)return;return void 0===a&&(a=t),e.F&&Ds(a,!0),a}_s(21,t)},this.produceWithPatches=function(t,r){return"function"==typeof t?function(r){for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return e.produceWithPatches(r,(function(e){return t.apply(void 0,[e].concat(o))}))}:[e.produce(t,r,(function(t,e){n=t,o=e})),n,o];var n,o},"boolean"==typeof(null==t?void 0:t.useProxies)&&this.setUseProxies(t.useProxies),"boolean"==typeof(null==t?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze)}var e=t.prototype;return e.createDraft=function(t){js(t)||_s(8),ms(t)&&(t=Js(t));var e=zs(this),r=Gs(this,t,void 0);return r[nc].C=!0,Vs(e),r},e.finishDraft=function(t,e){var r=(t&&t[nc]).A;return Ms(r,e),Ns(void 0,r)},e.setAutoFreeze=function(t){this.F=t},e.setUseProxies=function(t){t&&!tc&&_s(20),this.g=t},e.applyPatches=function(t,e){var r;for(r=e.length-1;r>=0;r--){var n=e[r];if(0===n.path.length&&"replace"===n.op){t=n.value;break}}var o=Bs("Patches").$;return ms(t)?o(t,e):this.produce(t,(function(t){return o(t,e.slice(r+1))}))},t}(),fc=new lc,hc=(fc.produce,fc.produceWithPatches.bind(fc),fc.setAutoFreeze.bind(fc),fc.setUseProxies.bind(fc),fc.applyPatches.bind(fc),fc.createDraft.bind(fc),fc.finishDraft.bind(fc),{currentProjectStateDefinitionVersion:"0.4.0"});async function dc(t,e,r){await bs(0),t.transaction((({drafts:t})=>{var n;const o=e.address.projectId;function i(){t.ephemeral.coreByProject[o].loadingState={type:"loaded"}}t.ephemeral.coreByProject[o]={lastExportedObject:null,loadingState:{type:"loading"}},t.ahistoric.coreByProject[o]={ahistoricStuff:""};const a=null==(ms(s=t.historic)||_s(23,s),n=s[nc].t)?void 0:n.coreByProject[e.address.projectId];var s,c,u;a?r&&-1==a.revisionHistory.indexOf(r.revisionHistory[0])?(c=r,t.ephemeral.coreByProject[o].loadingState={type:"browserStateIsNotBasedOnDiskState",onDiskState:c}):i():r?(u=r,t.ephemeral.coreByProject[o].loadingState={type:"loaded"},t.historic.coreByProject[o]=u):(t.ephemeral.coreByProject[o].loadingState={type:"loaded"},t.historic.coreByProject[o]={sheetsById:{},definitionVersion:hc.currentProjectStateDefinitionVersion,revisionHistory:[]})}))}function pc(){}function vc(t){var e,r;const n=(null==(e=null==t?void 0:t.logging)?void 0:e.internal)?null!=(r=t.logging.min)?r:256:1/0,o=n<=512,i=Ui(void 0,{_debug:n<=128?console.debug.bind(console,"_coreLogger(TheatreInternalLogger) debug"):pc,_error:o?console.error.bind(console,"_coreLogger(TheatreInternalLogger) error"):pc});if(t){const{logger:e,logging:r}=t;e&&i.configureLogger(e),r?i.configureLogging(r):i.configureLogging({dev:!1})}return i.getLogger().named("Theatre")}var gc=class{constructor(t,e={},r){var n;this.config=e,this.publicApi=r,j(this,"pointers"),j(this,"_pointerProxies"),j(this,"address"),j(this,"_studioReadyDeferred"),j(this,"_assetStorageReadyDeferred"),j(this,"_readyPromise"),j(this,"_sheetTemplates",new ys.Atom({})),j(this,"sheetTemplatesP",this._sheetTemplates.pointer),j(this,"_studio"),j(this,"assetStorage"),j(this,"type","Theatre_Project"),j(this,"_logger"),this._logger=vc({logging:{dev:!0}}).named("Project",t),this._logger.traceDev("creating project"),this.address={projectId:t};const o=new ys.Atom({ahistoric:{ahistoricStuff:""},historic:null!=(n=e.state)?n:{sheetsById:{},definitionVersion:hc.currentProjectStateDefinitionVersion,revisionHistory:[]},ephemeral:{loadingState:{type:"loaded"},lastExportedObject:null}});this._assetStorageReadyDeferred=ua(),this.assetStorage={getAssetUrl:t=>{var r;return"".concat(null==(r=e.assets)?void 0:r.baseUrl,"/").concat(t)},createAsset:()=>{throw new Error("Please wait for Project.ready to use assets.")}},this._pointerProxies={historic:new gs.PointerProxy(o.pointer.historic),ahistoric:new gs.PointerProxy(o.pointer.ahistoric),ephemeral:new gs.PointerProxy(o.pointer.ephemeral)},this.pointers={historic:this._pointerProxies.historic.pointer,ahistoric:this._pointerProxies.ahistoric.pointer,ephemeral:this._pointerProxies.ephemeral.pointer},x.add(t,this),this._studioReadyDeferred=ua(),this._readyPromise=Promise.all([this._studioReadyDeferred.promise,this._assetStorageReadyDeferred.promise]).then((()=>{})),e.state?setTimeout((()=>{this._studio||(this._studioReadyDeferred.resolve(void 0),this._assetStorageReadyDeferred.resolve(void 0),this._logger._trace("ready deferred resolved with no state"))}),0):"undefined"==typeof window?console.error('Argument config.state in Theatre.getProject("'.concat(t,'", config) is empty. ')+"You can safely ignore this message if you're developing a Next.js/Remix project in development mode. But if you are shipping to your end-users, then you need to set config.state, otherwise your project's state will be empty and nothing will animate. Learn more at https://www.theatrejs.com/docs/latest/manual/projects#state"):setTimeout((()=>{if(!this._studio)throw new Error('Argument config.state in Theatre.getProject("'.concat(t,'", config) is empty. This is fine ')+"while you are using @theatre/core along with @theatre/studio. But since @theatre/studio "+'is not loaded, the state of project "'.concat(t,'" will be empty.\n\n')+"To fix this, you need to add @theatre/studio into the bundle and export the project's state. Learn how to do that at https://www.theatrejs.com/docs/latest/manual/projects#state\n")}),1e3)}attachToStudio(t){if(this._studio){if(this._studio!==t)throw new Error("Project ".concat(this.address.projectId," is already attached to studio ").concat(this._studio.address.studioId));console.warn("Project ".concat(this.address.projectId," is already attached to studio ").concat(this._studio.address.studioId))}else this._studio=t,t.initialized.then((async()=>{var e;await dc(t,this,this.config.state),this._pointerProxies.historic.setPointer(t.atomP.historic.coreByProject[this.address.projectId]),this._pointerProxies.ahistoric.setPointer(t.atomP.ahistoric.coreByProject[this.address.projectId]),this._pointerProxies.ephemeral.setPointer(t.atomP.ephemeral.coreByProject[this.address.projectId]),await t.createAssetStorage(this,null==(e=this.config.assets)?void 0:e.baseUrl).then((t=>{this.assetStorage=t,this._assetStorageReadyDeferred.resolve(void 0)})),this._studioReadyDeferred.resolve(void 0)})).catch((t=>{throw console.error(t),t}))}get isAttachedToStudio(){return!!this._studio}get ready(){return this._readyPromise}isReady(){return"resolved"===this._studioReadyDeferred.status&&"resolved"===this._assetStorageReadyDeferred.status}getOrCreateSheet(t,e="default"){let r=this._sheetTemplates.get()[t];return r||(r=new vs(this,t),this._sheetTemplates.reduce((e=>g(v({},e),{[t]:r})))),r.getInstance(e)}},yc=class{get type(){return"Theatre_Project_PublicAPI"}constructor(t,e={}){C(this,new gc(t,e,this))}get ready(){return I(this).ready}get isReady(){return I(this).isReady()}get address(){return v({},I(this).address)}getAssetUrl(t){if(this.isReady)return t.id?I(this).assetStorage.getAssetUrl(t.id):void 0;console.error("Calling `project.getAssetUrl()` before `project.ready` is resolved, will always return `undefined`. Either use `project.ready.then(() => project.getAssetUrl())` or `await project.ready` before calling `project.getAssetUrl()`.")}sheet(t,e="default"){const r=ss(t);return I(this).getOrCreateSheet(r,e).publicApi}},bc=(m(S()),r(4771)),_c=r(4771);function mc(t,e={}){const r=x.get(t);if(r)return r.publicApi;const n=vc().named("Project",t);return e.state?(jc(t,e.state),n._debug("deep validated config.state on disk")):n._debug("no config.state"),new yc(t,e)}var jc=(t,e)=>{((t,e)=>{if(Array.isArray(e)||null==e||e.definitionVersion!==hc.currentProjectStateDefinitionVersion)throw new oa("Error validating conf.state in Theatre.getProject(".concat(JSON.stringify(t),", conf). The state seems to be formatted in a way that is unreadable to Theatre.js. Read more at https://www.theatrejs.com/docs/latest/manual/projects#state"))})(t,e)};function wc(t,e,r){const n=r?I(r).ticker:Pa();if((0,bc.isPointer)(t)){return(0,_c.pointerToPrism)(t).onChange(n,e,!0)}if((0,_c.isPrism)(t))return t.onChange(n,e,!0);throw new Error("Called onChange(p) where p is neither a pointer nor a prism.")}function Pc(t){if((0,bc.isPointer)(t))return(0,_c.pointerToPrism)(t).getValue();throw new Error("Called val(p) where p is not a pointer.")}var Oc=class{constructor(){j(this,"_studio")}get type(){return"Theatre_CoreBundle"}get version(){return"0.7.0"}getBitsForStudio(t,e){if(this._studio)throw new Error("@theatre/core is already attached to @theatre/studio");this._studio=t;e({projectsP:x.atom.pointer.projects,privateAPI:I,coreExports:A,getCoreRafDriver:wa})}};!function(){if("undefined"==typeof window)return;const t=window[pa];if(void 0!==t)throw"object"==typeof t&&t&&"string"==typeof t.version?new Error("It seems that the module '@theatre/core' is loaded more than once. This could have two possible causes:\n1. You might have two separate versions of Theatre.js in node_modules.\n2. Or this might be a bundling misconfiguration, in case you're using a bundler like Webpack/ESBuild/Rollup.\n\nNote that it **is okay** to import '@theatre/core' multiple times. But those imports should point to the same module."):new Error("The variable window.".concat(pa," seems to be already set by a module other than @theatre/core."));const e=new Oc;window[pa]=e;const r=window.__TheatreJS_StudioBundle;r&&null!==r&&"Theatre_StudioBundle"===r.type&&r.registerCoreBundle(e)}()}}]);
//# sourceMappingURL=fde15935-1e8c3d28a4ed7f26e080.js.map